Y = matrix(cbind(rnorm(par_n, mean=10, sd=0.01), rnorm(par_n)), ncol=2)
output = test_time_comparison(X, Y, lambda=par_lbd)
output$time
par(mfrow=c(1,2), pty="s")
image(output$plan$emd, main="Exact LP")
image(output$plan$entropic, main="Entropic")
par_n = 50
par_lbd = 0.01
X = matrix(rnorm(par_n*2), ncol=2)
Y = matrix(cbind(rnorm(par_n, mean=10, sd=0.01), rnorm(par_n)), ncol=2)
output = test_time_comparison(X, Y, lambda=par_lbd)
output$time
par(mfrow=c(1,2), pty="s")
image(output$plan$emd, main="Exact LP")
image(output$plan$entropic, main="Entropic")
par_n = 50
par_lbd = 0.01
X = matrix(rnorm(par_n*2), ncol=2)
Y = matrix(cbind(rnorm(par_n, mean=10, sd=0.01), rnorm(par_n)), ncol=2)
output = test_time_comparison(X, Y, lambda=par_lbd)
output$time
par(mfrow=c(1,2), pty="s")
image(output$plan$emd, main="Exact LP")
image(output$plan$entropic, main="Entropic")
par_n = 50
par_lbd = 0.01
X = matrix(rnorm(par_n*2), ncol=2)
Y = matrix(cbind(rnorm(par_n, mean=10, sd=0.01), rnorm(par_n)), ncol=2)
output = test_time_comparison(X, Y, lambda=par_lbd)
output$time
par(mfrow=c(1,2), pty="s")
image(output$plan$emd, main="Exact LP")
image(output$plan$entropic, main="Entropic")
par_n = 50
par_lbd = 0.01
X = matrix(rnorm(par_n*2), ncol=2)
Y = matrix(cbind(rnorm(par_n, mean=10, sd=0.01), rnorm(par_n)), ncol=2)
output = test_time_comparison(X, Y, lambda=par_lbd)
output$time
par(mfrow=c(1,2), pty="s")
image(output$plan$emd, main="Exact LP")
image(output$plan$entropic, main="Entropic")
50
par_n = 50
par_lbd = 0.01
X = matrix(rnorm(par_n*2), ncol=2)
Y = matrix(cbind(rnorm(par_n, mean=10, sd=0.01), rnorm(par_n)), ncol=2)
output = test_time_comparison(X, Y, lambda=par_lbd)
output$time
par(mfrow=c(1,2), pty="s")
image(output$plan$emd, main="Exact LP")
image(output$plan$entropic, main="Entropic")
par_n = 50
par_lbd = 0.001
X = matrix(rnorm(par_n*2), ncol=2)
Y = matrix(cbind(rnorm(par_n, mean=10, sd=0.01), rnorm(par_n)), ncol=2)
output = test_time_comparison(X, Y, lambda=par_lbd)
output$time
par(mfrow=c(1,2), pty="s")
image(output$plan$emd, main="Exact LP")
image(output$plan$entropic, main="Entropic")
par_n = 50
par_lbd = 0.001
X = matrix(rnorm(par_n*2), ncol=2)
Y = matrix(cbind(rnorm(par_n, mean=10, sd=0.01), rnorm(par_n)), ncol=2)
output = test_time_comparison(X, Y, lambda=par_lbd)
output$time
par(mfrow=c(1,2), pty="s")
image(output$plan$emd, main="Exact LP")
image(output$plan$entropic, main="Entropic")
par_n = 500
par_lbd = 0.001
X = matrix(rnorm(par_n*2), ncol=2)
Y = matrix(cbind(rnorm(par_n, mean=10, sd=0.01), rnorm(par_n)), ncol=2)
output = test_time_comparison(X, Y, lambda=par_lbd)
output$time
par(mfrow=c(1,2), pty="s")
image(output$plan$emd, main="Exact LP")
image(output$plan$entropic, main="Entropic")
pkgdown::build_site()
help(hist)
x = hist(rnorm(100))
x$breaks
x$counts
x$mids
#----------------------------------------------------------------------
#                      Binned from Gaussian and Uniform
#
# Create two types of histograms with the same binning. One is from
# the standard normal and the other from uniform distribution in [-5,5].
#----------------------------------------------------------------------
# GENERATE 20 HISTOGRAMS
set.seed(100)
hist20 = list()
bk = seq(from=-10, to=10, length.out=20) # common breaks
for (i in 1:10){
hist20[[i]] = hist(stats::rnorm(100), breaks=bk, plot=FALSE)
hist20[[i+10]] = hist(stats::runif(100, min=-5, max=5), breaks=bk, plot=FALSE)
}
# COMPUTE THE PAIRWISE DISTANCE
pdmat = array(0,c(20,20))
for (i in 1:19){
for (j in (i+1):20){
pdmat[i,j] = hdist(hist20[[i]], hist20[[j]], p=2)$distance
pdmat[j,i] = pdmat[i,j]
}
}
#----------------------------------------------------------------------
#                      Binned from Gaussian and Uniform
#
# Create two types of histograms with the same binning. One is from
# the standard normal and the other from uniform distribution in [-5,5].
#----------------------------------------------------------------------
# GENERATE 20 HISTOGRAMS
set.seed(100)
hist20 = list()
bk = seq(from=-10, to=10, length.out=20) # common breaks
for (i in 1:10){
hist20[[i]] = hist(stats::rnorm(100), breaks=bk, plot=FALSE)
hist20[[i+10]] = hist(stats::runif(100, min=-5, max=5), breaks=bk, plot=FALSE)
}
# COMPUTE THE PAIRWISE DISTANCE
pdmat = array(0,c(20,20))
for (i in 1:19){
for (j in (i+1):20){
pdmat[i,j] = hdist(hist20[[i]], hist20[[j]], p=2)$distance
pdmat[j,i] = pdmat[i,j]
}
}
#----------------------------------------------------------------------
#                      Binned from Gaussian and Uniform
#
# Create two types of histograms with the same binning. One is from
# the standard normal and the other from uniform distribution in [-5,5].
#----------------------------------------------------------------------
# GENERATE 20 HISTOGRAMS
set.seed(100)
hist20 = list()
bk = seq(from=-10, to=10, length.out=20) # common breaks
for (i in 1:10){
hist20[[i]] = hist(stats::rnorm(100), breaks=bk, plot=FALSE)
hist20[[i+10]] = hist(stats::runif(100, min=-5, max=5), breaks=bk, plot=FALSE)
}
# COMPUTE THE PAIRWISE DISTANCE
pdmat = array(0,c(20,20))
for (i in 1:19){
for (j in (i+1):20){
pdmat[i,j] = hdist(hist20[[i]], hist20[[j]], p=2)$distance
pdmat[j,i] = pdmat[i,j]
}
}
# VISUALIZE
opar <- par(no.readonly=TRUE)
par(pty="s")
image(pdmat, axes=FALSE, main="Pairwise 2-Wasserstein Distance between Histograms")
par(opar)
graphics.off()
set.seed(496)
sample(1:8)
x = cbind(rnorm(20, mean=-5), rnorm(20, mean=5))
hist(x, breaks="FD")
hist(x)
x = cbind(rnorm(200, mean=-5), rnorm(100, mean=5))
hist(x)
hist(x, breaks="FD")
hist(x, breaks="FD")
hist(x, breaks="FD")
graphics.off()
graphics.off()
hist(x, breaks="FD")
help(hist)
#----------------------------------------------------------------------
#                      Binned from Two Gaussians
#
# EXAMPLE : Very Small Example for CRAN; just showing how to use it!
#----------------------------------------------------------------------
# GENERATE FROM TWO GAUSSIANS WITH DIFFERENT MEANS
set.seed(100)
x  = stats::rnorm(1000, mean=-4, sd=0.5)
y  = stats::rnorm(1000, mean=+4, sd=0.5)
bk = seq(from=-10, to=10, length.out=20)
# HISTOGRAMS WITH COMMON BREAKS
histxy = list()
histxy[[1]] = hist(x, breaks=bk, plot=FALSE)
histxy[[2]] = hist(y, breaks=bk, plot=FALSE)
# COMPUTE
hh = histbary(histxy, maxiter=5)
# VISUALIZE
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2))
barplot(histxy[[1]]$density, col=rgb(0,0,1,1/4),
ylim=c(0, 0.75), main="Two Histograms")
barplot(histxy[[2]]$density, col=rgb(1,0,0,1/4),
ylim=c(0, 0.75), add=TRUE)
barplot(hh$density, main="Barycenter",
ylim=c(0, 0.75))
par(opar)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2), pty="s")
barplot(histxy[[1]]$density, col=rgb(0,0,1,1/4),
ylim=c(0, 0.75), main="Two Histograms")
barplot(histxy[[2]]$density, col=rgb(1,0,0,1/4),
ylim=c(0, 0.75), add=TRUE)
barplot(hh$density, main="Barycenter",
ylim=c(0, 0.75))
par(opar)
pkgdown::build_site()
#----------------------------------------------------------------------
# COMMON SETTING
set.seed(100)
bk = seq(from=-10, to=10, length.out=20)
# GENERATE HISTOGRAMS WITH COMMON BREAKS
hist_all = list()
for (i in 1:18){
hist_all[[i]] = stats::rnorm(200, mean=-4, sd=0.5)
}
for (j in 19:20){
hist_all[[j]] = stats::rnorm(200, mean=+4, sd=0.5)
}
# COMPUTE THE BARYCENTER AND THE MEDIAN
h_bary = histbary(hist_all)
# COMMON SETTING
set.seed(100)
bk = seq(from=-10, to=10, length.out=20)
# GENERATE HISTOGRAMS WITH COMMON BREAKS
hist_all = list()
for (i in 1:18){
hist_all[[i]] = hist(stats::rnorm(200, mean=-4, sd=0.5), breaks=bk)
}
for (j in 19:20){
hist_all[[j]] = hist(stats::rnorm(200, mean=+4, sd=0.5), breaks=bk)
}
# COMPUTE THE BARYCENTER AND THE MEDIAN
h_bary = histbary(hist_all)
h_med  = histmed(hist_all)
hist_all = list()
for (i in 1:18){
hist_all[[i]] = hist(stats::rnorm(200, mean=-4, sd=0.5), breaks=bk)
}
for (j in 19:20){
hist_all[[j]] = hist(stats::rnorm(200, mean=+4, sd=0.5), breaks=bk)
}
# COMPUTE THE BARYCENTER AND THE MEDIAN
h_bary = histbary(hist_all)
h_med  = histmed(hist_all)
# VISUALIZE
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2), pty="s")
barplot(hist_all[[1]]$density, col=rgb(0,0,1,1/4),
ylim=c(0, 0.75), main="Two Types")
barplot(hist_all[[20]]$density, col=rgb(1,0,0,1/4),
ylim=c(0, 0.75), add=TRUE)
barplot(h_med$density,  main="Median", ylim=c(0, 0.75))
barplot(h_bary$density, main="Barycenter", ylim=c(0, 0.75))
par(opar)
# COMMON SETTING
set.seed(100)
bk = seq(from=-10, to=10, length.out=20)
# GENERATE HISTOGRAMS WITH COMMON BREAKS
hist_all = list()
for (i in 1:18){
hist_all[[i]] = hist(stats::rnorm(200, mean=-4, sd=0.5), breaks=bk)
}
for (j in 19:20){
hist_all[[j]] = hist(stats::rnorm(200, mean=+4, sd=0.5), breaks=bk)
}
# COMPUTE THE BARYCENTER AND THE MEDIAN
h_bary = histbary(hist_all)
h_med  = histmed(hist_all)
# VISUALIZE
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,3), pty="s")
barplot(hist_all[[1]]$density, col=rgb(0,0,1,1/4),
ylim=c(0, 0.75), main="Two Types")
barplot(hist_all[[20]]$density, col=rgb(1,0,0,1/4),
ylim=c(0, 0.75), add=TRUE)
barplot(h_med$density,  main="Median", ylim=c(0, 0.75))
barplot(h_bary$density, main="Barycenter", ylim=c(0, 0.75))
par(opar)
}
set.seed(100)
bk = seq(from=-10, to=10, length.out=20)
n_signal = 15
# GENERATE HISTOGRAMS WITH COMMON BREAKS
hist_all = list()
for (i in 1:n_signal){
hist_all[[i]] = hist(stats::rnorm(200, mean=-4, sd=0.5), breaks=bk)
}
for (j in (n_signal+1):20){
hist_all[[j]] = hist(stats::rnorm(200, mean=+4, sd=0.5), breaks=bk)
}
# COMPUTE THE BARYCENTER AND THE MEDIAN
h_bary = histbary(hist_all)
h_med  = histmed(hist_all)
# VISUALIZE
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,3), pty="s")
barplot(hist_all[[1]]$density, col=rgb(0,0,1,1/4),
ylim=c(0, 0.75), main="Two Types")
barplot(hist_all[[20]]$density, col=rgb(1,0,0,1/4),
ylim=c(0, 0.75), add=TRUE)
barplot(h_med$density,  main="Median", ylim=c(0, 0.75))
barplot(h_bary$density, main="Barycenter", ylim=c(0, 0.75))
par(opar)
n_signal = 12
# GENERATE HISTOGRAMS WITH COMMON BREAKS
hist_all = list()
for (i in 1:n_signal){
hist_all[[i]] = hist(stats::rnorm(200, mean=-4, sd=0.5), breaks=bk)
}
for (j in (n_signal+1):20){
hist_all[[j]] = hist(stats::rnorm(200, mean=+4, sd=0.5), breaks=bk)
}
# COMPUTE THE BARYCENTER AND THE MEDIAN
h_bary = histbary(hist_all)
h_med  = histmed(hist_all)
# VISUALIZE
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,3), pty="s")
barplot(hist_all[[1]]$density, col=rgb(0,0,1,1/4),
ylim=c(0, 0.75), main="Two Types")
barplot(hist_all[[20]]$density, col=rgb(1,0,0,1/4),
ylim=c(0, 0.75), add=TRUE)
barplot(h_med$density,  main="Median", ylim=c(0, 0.75))
barplot(h_bary$density, main="Barycenter", ylim=c(0, 0.75))
par(opar)
barplot(h_med$density,  names.arg = round(h_med$mids, 1), las=2, main="Median", ylim=c(0, 0.75))
barplot(h_med$density,  names.arg = round(h_med$mids, 1), main="Median", ylim=c(0, 0.75))
# VISUALIZE
xt   <- names.arg = round(h_med$mids, 1)
# VISUALIZE
xt   <- names.arg = round(h_med$mids, 1)
# VISUALIZE
xt   <- round(h_med$mids, 1)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,3), pty="s")
barplot(hist_all[[1]]$density, col=rgb(0,0,1,1/4),
ylim=c(0, 0.75), main="Two Types")
barplot(hist_all[[20]]$density, col=rgb(1,0,0,1/4),
ylim=c(0, 0.75), add=TRUE)
barplot(h_med$density,  names.arg=xt, main="Median", ylim=c(0, 0.75))
barplot(h_bary$density, names.arg=xt, main="Barycenter", ylim=c(0, 0.75))
par(opar)
# VISUALIZE
xt   <- round(h_med$mids, 1)
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,3), pty="s")
barplot(hist_all[[1]]$density, col=rgb(0,0,1,1/4),
ylim=c(0, 0.75), main="Two Types", names.arg=xt)
barplot(hist_all[[20]]$density, col=rgb(1,0,0,1/4),
ylim=c(0, 0.75), add=TRUE)
barplot(h_med$density,  names.arg=xt, main="Median", ylim=c(0, 0.75))
barplot(h_bary$density, names.arg=xt, main="Barycenter", ylim=c(0, 0.75))
par(opar)
0help(hist)
help(hist)
set.seed(123)
x_source = rnorm(1000, mean=-5, sd=1/2)
x_target = rnorm(1000, mean=+5, sd=2)
# EXTRACT A COMMON SET OF BREAKS
common_hist = hist(c(x_source, x_target), plot=FALSE)
common_hist$breaks
plot(common_hist)
help(hist)
common_hist = hist(c(x_source, x_target), plot=FALSE, breaks="FD")
common_hist$breaks
common_hist = hist(c(x_source, x_target), plot=FALSE, breaks="Sturges")
common_hist$breaks
seq(from=0, to=1, length.out=5)
# BUILD HISTOGRAMS WITH COMMON BREAKS
bk = seq(from=-8, to=12, by=2)
h1 = hist(x_source, breaks=bk, plot=FALSE)
h2 = hist(x_target, breaks=bk, plot=FALSE)
h1$density
h2$density
#----------------------------------------------------------------------
#                      Interpolating Two Gaussians
#
# The source histogram is created from N(-5,1/4).
# The target histogram is created from N(+5,4)
#----------------------------------------------------------------------
# SETTING
set.seed(123)
x_source = rnorm(1000, mean=-5, sd=1/2)
x_target = rnorm(1000, mean=+5, sd=2)
# BUILD HISTOGRAMS WITH COMMON BREAKS
bk = seq(from=-8, to=12, by=2)
h1 = hist(x_source, breaks=bk, plot=FALSE)
h2 = hist(x_target, breaks=bk, plot=FALSE)
# INTERPOLATE WITH 5 GRID POINTS
h_path <- histinterp(h1, h2, t = seq(0, 1, length.out = 5))
h_path <- histinterp(h1, h2, t = seq(0, 1, length.out = 5))
h_path
h_path[[1]]
# VISUALIZE
y_slim <- c(0, max(h1$density, h2$density)) # shared y-limit
xt     <- round(h_med$mids, 1) # x-ticks
opar <- par(no.readonly = TRUE)
par(mfrow = c(1, 5), pty = "s")
for (i in 1:5){
barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim)
}
y_slim <- c(0, max(h1$density, h2$density)) # shared y-limit
xt     <- round(h1$mids, 1) # x-ticks
opar <- par(no.readonly = TRUE)
par(mfrow = c(1, 5), pty = "s")
for (i in 1:5){
barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim)
}
par(opar)
#                      Interpolating Two Gaussians
#
# The source histogram is created from N(-5,1/4).
# The target histogram is created from N(+5,4)
#----------------------------------------------------------------------
# SETTING
set.seed(123)
x_source = rnorm(1000, mean=-5, sd=1/2)
x_target = rnorm(1000, mean=+5, sd=2)
# BUILD HISTOGRAMS WITH COMMON BREAKS
bk = seq(from=-8, to=12, by=1)
h1 = hist(x_source, breaks=bk, plot=FALSE)
h2 = hist(x_target, breaks=bk, plot=FALSE)
# INTERPOLATE WITH 5 GRID POINTS
h_path <- histinterp(h1, h2, t = seq(0, 1, length.out = 5))
# VISUALIZE
y_slim <- c(0, max(h1$density, h2$density)) # shared y-limit
xt     <- round(h1$mids, 1) # x-ticks
opar <- par(no.readonly = TRUE)
par(mfrow = c(1, 5), pty = "s")
for (i in 1:5){
barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim)
}
par(opar)
# BUILD HISTOGRAMS WITH COMMON BREAKS
bk = seq(from=-8, to=12, by=1)
h1 = hist(x_source, breaks=bk, plot=FALSE)
h2 = hist(x_target, breaks=bk, plot=FALSE)
# INTERPOLATE WITH 5 GRID POINTS
h_path <- histinterp(h1, h2, t = seq(0, 1, length.out = 8))
# VISUALIZE
y_slim <- c(0, max(h1$density, h2$density)) # shared y-limit
xt     <- round(h1$mids, 1) # x-ticks
opar <- par(no.readonly = TRUE)
par(mfrow = c(2,4), pty = "s")
for (i in 1:8){
if (i < 2){
barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim,
main="Source", col=rgb(0,0,1,1/4))
} else if (i > 7){
barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim,
main="Target", col=rgb(1,0,0,1/4))
} else {
barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim,
col="gray90", main=sprintf("t = %.3f", (i-1)/7))
}
}
par(opar)
bk = seq(from=-8, to=12, by=2)
h1 = hist(x_source, breaks=bk, plot=FALSE)
h2 = hist(x_target, breaks=bk, plot=FALSE)
# INTERPOLATE WITH 5 GRID POINTS
h_path <- histinterp(h1, h2, t = seq(0, 1, length.out = 8))
# VISUALIZE
y_slim <- c(0, max(h1$density, h2$density)) # shared y-limit
xt     <- round(h1$mids, 1) # x-ticks
opar <- par(no.readonly = TRUE)
par(mfrow = c(2,4), pty = "s")
for (i in 1:8){
if (i < 2){
barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim,
main="Source", col=rgb(0,0,1,1/4))
} else if (i > 7){
barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim,
main="Target", col=rgb(1,0,0,1/4))
} else {
barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim,
col="gray90", main=sprintf("t = %.3f", (i-1)/7))
}
}
par(opar)
rm(list=ls())
pkgdown::build_site()
pkgdown::build_site()
graphics.off()
rm(list=ls())
pkgdown::build_site()
devtools::document()
pkgdown::build_site()
install.packages(c("e1071", "ggsci", "litedown", "metap", "performance", "RcppArmadillo", "reformulas", "selectr", "statnet.common", "wk"))
X = cbind(c(1,0,-1,0), c(0,1,0,-1))
S = cov(X)
S
eigen(S)
X = (3/2)*X
cov(X)
eigen(cov(X))
X
X
X = 2/3*X
eigen(cov(X))
t(X)%*%X/(3)
pak::pkg_install("rhub", dependencies = TRUE)
rhub::rhub_setup()
rhub::rhub_doctor()
usethis::create_github_token()
gitcreds::gitcreds_set()
rhub::rhub_platforms()
rhub::rhub_doctor()
rhub::rhub_check()
rhub::rhub_check()
pkgdown::build_site()
