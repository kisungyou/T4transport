[{"path":"https://www.kisungyou.com/T4transport/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 T4transport authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://www.kisungyou.com/T4transport/articles/basic_compute_distance.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Computing the Wasserstein distance","text":"Wasserstein distance (Villani 2003) provides natural geometrically meaningful way compare probability distributions. Unlike traditional dissimilarities Kullback–Leibler divergence total variation, reflects minimal “cost” transporting one distribution another, respect underlying geometry sample space. Formally, \\(p\\)-Wasserstein distance two probability measures \\(\\mu\\) \\(\\nu\\) metric space \\((\\mathcal{X}, d)\\) defined : \\[ W_p(\\mu, \\nu) = \\left( \\inf_{\\gamma \\\\Gamma(\\mu, \\nu)} \\int_{\\mathcal{X} \\times \\mathcal{X}} d(x, y)^p \\, d\\gamma(x, y) \\right)^{1/p}, \\] \\(\\Gamma(\\mu, \\nu)\\) denotes set couplings (.e., joint distributions) marginals \\(\\mu\\) \\(\\nu\\). known Kantrovich formulation (Kantorovitch 1958), differs original formulation Monge (1781) yet arises equivalent measure distance mild conditions.","code":""},{"path":"https://www.kisungyou.com/T4transport/articles/basic_compute_distance.html","id":"toy-example","dir":"Articles","previous_headings":"","what":"Toy example","title":"Computing the Wasserstein distance","text":"use two artificial datasets - cassini smiley - mlbench package demonstrate usage package. Let’s generate small samples cardinality \\(n=100\\). visual clarity, two datasets first normalized mean zero unit variance across dimensions, second one translated +5 \\(x\\)-direction.  shown figure, two datasets quite different terms shapes. Moreover, horizontal translation applied second dataset (smiley) makes distinct.","code":"# load the library library(mlbench)  # generate two datasets data1 = mlbench::mlbench.cassini(n=100)$x data2 = mlbench::mlbench.smiley(n=100)$x  # normalize the datasets data1 = as.matrix(scale(data1)) data2 = as.matrix(scale(data2))  # translate the second dataset data2[,1] = data2[,1] + 5  # plot the datasets plot(data1, col=\"blue\", pch=19, cex=0.5, main=\"Two datasets\",       xlim=c(-2, 7), xlab=\"x\", ylab=\"y\") points(data2[,1], data2[,2], col=\"red\", cex=0.5, pch=19)"},{"path":"https://www.kisungyou.com/T4transport/articles/basic_compute_distance.html","id":"how-to-compute","dir":"Articles","previous_headings":"","what":"How to compute?","title":"Computing the Wasserstein distance","text":"Per formulation Kantrovich, computing Wasserstein distance requires solving linear programming problem. T4transport, wasserstein() function achieves . Let’s see can use . Assume consider simplest case order 2. computed Wasserstein distance order 2 two empirical measures 5.0194. Another benefit Kantrovich formulation returns optimal coupling matrix matches elements two sets. attained coupling matrix \\(\\hat{\\Gamma}\\) given follows.  Furthermore, coupling can shown within original scatterplot two datasets considering bipartite graph representation.  figure, edges connecting dots represent optimal coupling two empirical measures. thickness edges proportional amount mass transported points, can interpreted “flow” transportation problem.","code":"# call the function output = wasserstein(data1, data2, p=2)  # print the output print(paste0(\"2-wasserstein distance: \",round(output$distance, 4))) ## [1] \"2-wasserstein distance: 5.0194\""},{"path":"https://www.kisungyou.com/T4transport/articles/basic_compute_distance.html","id":"alternative-input","dir":"Articles","previous_headings":"","what":"Alternative input","title":"Computing the Wasserstein distance","text":"often case cross distances two empirical measures, rather measures . instance, current wasserstein() function assumes Euclidean-valued atoms. practical scenarios, plausible distances dissimilarities according user-defined metric. wassersteinD() function choice scenarios. Supplying cross distance matrix also returns 2-Wasserstein distance value 5.0194, identical value obtained (5.0194).","code":"# compute the cross distance with a helper function cross_dist <- function(X, Y) {   X2 <- rowSums(X^2)   Y2 <- rowSums(Y^2)   sqrt(outer(X2, Y2, \"+\") - 2 * tcrossprod(X, Y)) } cdist = cross_dist(data1, data2)  # call the function crossed = wassersteinD(cdist, p=2)  # print the output print(paste0(\"2-wasserstein distance: \",round(crossed$distance, 4))) ## [1] \"2-wasserstein distance: 5.0194\""},{"path":"https://www.kisungyou.com/T4transport/articles/basic_compute_distance.html","id":"disclaimer","dir":"Articles","previous_headings":"","what":"Disclaimer","title":"Computing the Wasserstein distance","text":"Computing Wasserstein distance using linear programming (LP) solver classical approach based Kantrovich formulation. typically included core method OT libraries. However, approach scale well large-scale data, since LP problem involves \\(n\\times m\\) variables requires \\(\\mathcal{O}(n^2)\\) memory least \\(\\mathcal{O}(n^3)\\) time worst case. reason, bring alternative algorithms package hope enjoy exploring .","code":""},{"path":[]},{"path":"https://www.kisungyou.com/T4transport/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kisung . Author, maintainer.","code":""},{"path":"https://www.kisungyou.com/T4transport/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"K (2025). T4transport: Tools Computational Optimal Transport. R package version 0.1.7, https://www.kisungyou.com/T4transport/.","code":"@Manual{,   title = {T4transport: Tools for Computational Optimal Transport},   author = {Kisung You},   year = {2025},   note = {R package version 0.1.7},   url = {https://www.kisungyou.com/T4transport/}, }"},{"path":"https://www.kisungyou.com/T4transport/index.html","id":"tools-for-computational-optimal-transport-in-r","dir":"","previous_headings":"","what":"Tools for Computational Optimal Transport","title":"Tools for Computational Optimal Transport","text":"introduce T4transport, R package designed computational toolkit compiles collection algorithms field optimal transport.","code":""},{"path":"https://www.kisungyou.com/T4transport/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Tools for Computational Optimal Transport","text":"Option 1 : released version CRAN. Option 2 : development version GitHub.","code":"install.packages(\"T4transport\") # install.packages(\"devtools\") devtools::install_github(\"kisungyou/T4transport\")"},{"path":"https://www.kisungyou.com/T4transport/reference/digit3.html","id":null,"dir":"Reference","previous_headings":"","what":"MNIST Images of Digit 3 — digit3","title":"MNIST Images of Digit 3 — digit3","text":"digit3 contains 2000 images famous MNIST dataset digit 3. element list image represented \\((28\\times 28)\\) matrix sums 1. normalization conventional hurt visualization via basic `image()` function.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/digit3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MNIST Images of Digit 3 — digit3","text":"","code":"data(digit3)"},{"path":"https://www.kisungyou.com/T4transport/reference/digit3.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"MNIST Images of Digit 3 — digit3","text":"length-\\(2000\\) named list \"digit3\" \\((28\\times 28)\\) matrices.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/digit3.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MNIST Images of Digit 3 — digit3","text":"","code":"## LOAD THE DATA data(digit3)  ## SHOW A FEW opar <- par(no.readonly=TRUE) par(mfrow=c(2,4), pty=\"s\") for (i in 1:8){   image(digit3[[i]]) }  par(opar)"},{"path":"https://www.kisungyou.com/T4transport/reference/digits.html","id":null,"dir":"Reference","previous_headings":"","what":"MNIST Images of All Digits — digits","title":"MNIST Images of All Digits — digits","text":"digits contains 5000 images famous MNIST dataset digits, consisting 500 images per digit class 0 9. digit image represented \\((28\\times 28)\\) matrix sums 1. normalization conventional hurt visualization via basic `image()` function.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/digits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MNIST Images of All Digits — digits","text":"","code":"data(digits)"},{"path":"https://www.kisungyou.com/T4transport/reference/digits.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"MNIST Images of All Digits — digits","text":"named list \"digits\" containing image length-5000 list \\((28\\times 28)\\) image matrices. label length-5000 vector class labels 0 9.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/digits.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MNIST Images of All Digits — digits","text":"","code":"## LOAD THE DATA data(digits)  ## SHOW A FEW #  Select 9 random images subimgs = digits$image[sample(1:5000, 9)]  opar <- par(no.readonly=TRUE) par(mfrow=c(3,3), pty=\"s\") for (i in 1:9){   image(subimgs[[i]]) }  par(opar)"},{"path":"https://www.kisungyou.com/T4transport/reference/ecdfbary.html","id":null,"dir":"Reference","previous_headings":"","what":"Barycenter of Empirical CDFs — ecdfbary","title":"Barycenter of Empirical CDFs — ecdfbary","text":"Given collection empirical cumulative distribution functions \\(F^(x)\\) \\(=1,\\ldots,N\\), compute Wasserstein barycenter order 2. obtained taking weighted average set corresponding quantile functions.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/ecdfbary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Barycenter of Empirical CDFs — ecdfbary","text":"","code":"ecdfbary(ecdfs, weights = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/ecdfbary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Barycenter of Empirical CDFs — ecdfbary","text":"ecdfs length-\\(N\\) list \"ecdf\" objects [stats::ecdf()]. weights weight image; NULL (default), uniform weight set. Otherwise, length-\\(N\\) vector nonnegative weights. ... extra parameters including abstol stopping criterion iterations (default: 1e-8). maxiter maximum number iterations (default: 496).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/ecdfbary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Barycenter of Empirical CDFs — ecdfbary","text":"\"ecdf\" object Wasserstein barycenter.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/ecdfbary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Barycenter of Empirical CDFs — ecdfbary","text":"","code":"#---------------------------------------------------------------------- #                         Two Gaussians # # Two Gaussian distributions are parametrized as follows. # Type 1 : (mean, var) = (-4, 1/4) # Type 2 : (mean, var) = (+4, 1/4) #---------------------------------------------------------------------- # GENERATE ECDFs ecdf_list = list() ecdf_list[[1]] = stats::ecdf(stats::rnorm(200, mean=-4, sd=0.5)) ecdf_list[[2]] = stats::ecdf(stats::rnorm(200, mean=+4, sd=0.5))  # COMPUTE THE BARYCENTER OF EQUAL WEIGHTS emean = ecdfbary(ecdf_list)  # QUANTITIES FOR PLOTTING x_grid  = seq(from=-8, to=8, length.out=100) y_type1 = ecdf_list[[1]](x_grid) y_type2 = ecdf_list[[2]](x_grid) y_bary  = emean(x_grid)  # VISUALIZE opar <- par(no.readonly=TRUE) plot(x_grid, y_bary, lwd=3, col=\"red\", type=\"l\",      main=\"Barycenter\", xlab=\"x\", ylab=\"Fn(x)\") lines(x_grid, y_type1, col=\"gray50\", lty=3) lines(x_grid, y_type2, col=\"gray50\", lty=3)  par(opar)"},{"path":"https://www.kisungyou.com/T4transport/reference/ecdfmed.html","id":null,"dir":"Reference","previous_headings":"","what":"Wasserstein Median of Empirical CDFs — ecdfmed","title":"Wasserstein Median of Empirical CDFs — ecdfmed","text":"Given collection empirical cumulative distribution functions \\(F^(x)\\) \\(=1,\\ldots,N\\), compute Wasserstein median. obtained functional variant Weiszfeld algorithm set quantile functions.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/ecdfmed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wasserstein Median of Empirical CDFs — ecdfmed","text":"","code":"ecdfmed(ecdfs, weights = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/ecdfmed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wasserstein Median of Empirical CDFs — ecdfmed","text":"ecdfs length-\\(N\\) list \"ecdf\" objects [stats::ecdf()]. weights weight image; NULL (default), uniform weight set. Otherwise, length-\\(N\\) vector nonnegative weights. ... extra parameters including abstol stopping criterion iterations (default: 1e-8). maxiter maximum number iterations (default: 496).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/ecdfmed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wasserstein Median of Empirical CDFs — ecdfmed","text":"\"ecdf\" object Wasserstein median.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/ecdfmed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wasserstein Median of Empirical CDFs — ecdfmed","text":"","code":"# \\donttest{ #---------------------------------------------------------------------- #                         Tree Gaussians # # Three Gaussian distributions are parametrized as follows. # Type 1 : (mean, sd) = (-4, 1) # Type 2 : (mean, sd) = ( 0, 1/5) # Type 3 : (mean, sd) = (+6, 1/2) #---------------------------------------------------------------------- # GENERATE ECDFs ecdf_list = list() ecdf_list[[1]] = stats::ecdf(stats::rnorm(200, mean=-4, sd=1)) ecdf_list[[2]] = stats::ecdf(stats::rnorm(200, mean=+4, sd=0.2)) ecdf_list[[3]] = stats::ecdf(stats::rnorm(200, mean=+6, sd=0.5))  # COMPUTE THE MEDIAN emeds = ecdfmed(ecdf_list)  # COMPUTE THE BARYCENTER emean = ecdfbary(ecdf_list)  # QUANTITIES FOR PLOTTING x_grid  = seq(from=-8, to=10, length.out=500) y_type1 = ecdf_list[[1]](x_grid) y_type2 = ecdf_list[[2]](x_grid) y_type3 = ecdf_list[[3]](x_grid)  y_bary = emean(x_grid) y_meds = emeds(x_grid)  # VISUALIZE opar <- par(no.readonly=TRUE) plot(x_grid, y_bary, lwd=3, col=\"orange\", type=\"l\",      main=\"Wasserstein Median & Barycenter\",       xlab=\"x\", ylab=\"Fn(x)\", lty=2) lines(x_grid, y_meds, lwd=3, col=\"blue\", lty=2) lines(x_grid, y_type1, col=\"gray50\", lty=3) lines(x_grid, y_type2, col=\"gray50\", lty=3) lines(x_grid, y_type3, col=\"gray50\", lty=3) legend(\"topleft\", legend=c(\"Median\",\"Barycenter\"),         lwd=3, lty=2, col=c(\"blue\",\"orange\"))  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/fbary14C.html","id":null,"dir":"Reference","previous_headings":"","what":"Fixed-Support Barycenter by Cuturi & Doucet (2014) — fbary14C","title":"Fixed-Support Barycenter by Cuturi & Doucet (2014) — fbary14C","text":"Given \\(K\\) empirical measures \\(\\mu_1, \\mu_2, \\ldots, \\mu_K\\) possibly different cardinalities, wasserstein barycenter \\(\\mu^*\\) solution following problem $$\\sum_{k=1}^K \\pi_k \\mathcal{W}_p^p (\\mu, \\mu_k)$$ \\(\\pi_k\\)'s relative weights empirical measures. assume either (1) support atoms Euclidean space given, (2) pairwise distances atoms fixed support empirical measures given. Algorithmically, subgradient method subgradient approximated using entropic regularization.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/fbary14C.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fixed-Support Barycenter by Cuturi & Doucet (2014) — fbary14C","text":"","code":"fbary14C(   support,   atoms,   marginals = NULL,   weights = NULL,   lambda = 0.1,   p = 2,   ... )  fbary14Cdist(   distances,   marginals = NULL,   weights = NULL,   lambda = 0.1,   p = 2,   ... )"},{"path":"https://www.kisungyou.com/T4transport/reference/fbary14C.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fixed-Support Barycenter by Cuturi & Doucet (2014) — fbary14C","text":"support \\((N\\times P)\\) matrix rows atoms fixed support. atoms length-\\(K\\) list element \\((N_k \\times P)\\) matrix atoms. marginals marginal distribution empirical measures; NULL (default), uniform weights set measures. Otherwise, length-\\(K\\) list element length-\\(N_i\\) vector nonnegative weights sum 1. weights weights individual measure; NULL (default), measure considered equally. Otherwise, length-\\(K\\) vector. lambda regularization parameter (default: 0.1). p exponent order distance (default: 2). ... extra parameters including abstol stopping criterion iterations (default: 1e-10). init.vec initial vector (default: uniform weight). maxiter maximum number iterations (default: 496). print.progress logical show current iteration (default: FALSE). distances length-\\(K\\) list element \\((N\\times N_k)\\) pairwise distance atoms fixed support given measures.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/fbary14C.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fixed-Support Barycenter by Cuturi & Doucet (2014) — fbary14C","text":"length-\\(N\\) vector probability vector.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/fbary14C.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fixed-Support Barycenter by Cuturi & Doucet (2014) — fbary14C","text":"Cuturi M, Doucet (2014-06-22/2014-06-24). “Fast Computation Wasserstein Barycenters.” Xing EP, Jebara T (eds.), Proceedings 31st International Conference Machine Learning, volume 32 Proceedings Machine Learning Research, 685–693.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/fbary14C.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fixed-Support Barycenter by Cuturi & Doucet (2014) — fbary14C","text":"","code":"# \\donttest{ #------------------------------------------------------------------- #     Wasserstein Barycenter for Fixed Atoms with Two Gaussians # # * class 1 : samples from Gaussian with mean=(-4, -4) # * class 2 : samples from Gaussian with mean=(+4, +4) # * target support consists of 7 integer points from -6 to 6, #   where ideally, weight is concentrated near 0 since it's average! #------------------------------------------------------------------- ## GENERATE DATA #  Empirical Measures set.seed(100) ndat = 100 dat1 = matrix(rnorm(ndat*2, mean=-4, sd=0.5),ncol=2) dat2 = matrix(rnorm(ndat*2, mean=+4, sd=0.5),ncol=2)   myatoms = list() myatoms[[1]] = dat1 myatoms[[2]] = dat2 mydata = rbind(dat1, dat2)  #  Fixed Support support = cbind(seq(from=-8,to=8,by=2),                 seq(from=-8,to=8,by=2)) ## COMPUTE comp1 = fbary14C(support, myatoms, lambda=0.5, maxiter=10) comp2 = fbary14C(support, myatoms, lambda=1,   maxiter=10) comp3 = fbary14C(support, myatoms, lambda=10,  maxiter=10)  ## VISUALIZE opar <- par(no.readonly=TRUE) par(mfrow=c(1,3), pty=\"s\") barplot(comp1, ylim=c(0,1), main=\"Probability\\n (lambda=0.5)\") barplot(comp2, ylim=c(0,1), main=\"Probability\\n (lambda=1)\") barplot(comp3, ylim=c(0,1), main=\"Probability\\n (lambda=10)\")  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/fbary15B.html","id":null,"dir":"Reference","previous_headings":"","what":"Fixed-Support Barycenter by Benamou et al. (2015) — fbary15B","title":"Fixed-Support Barycenter by Benamou et al. (2015) — fbary15B","text":"Given \\(K\\) empirical measures \\(\\mu_1, \\mu_2, \\ldots, \\mu_K\\) possibly different cardinalities, wasserstein barycenter \\(\\mu^*\\) solution following problem $$\\sum_{k=1}^K \\pi_k \\mathcal{W}_p^p (\\mu, \\mu_k)$$ \\(\\pi_k\\)'s relative weights empirical measures. assume either (1) support atoms Euclidean space given, (2) pairwise distances atoms fixed support empirical measures given. Authors proposed iterative Bregman projections conjunction entropic regularization.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/fbary15B.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fixed-Support Barycenter by Benamou et al. (2015) — fbary15B","text":"","code":"fbary15B(   support,   atoms,   marginals = NULL,   weights = NULL,   lambda = 0.1,   p = 2,   ... )  fbary15Bdist(   distances,   marginals = NULL,   weights = NULL,   lambda = 0.1,   p = 2,   ... )"},{"path":"https://www.kisungyou.com/T4transport/reference/fbary15B.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fixed-Support Barycenter by Benamou et al. (2015) — fbary15B","text":"support \\((N\\times P)\\) matrix rows atoms fixed support. atoms length-\\(K\\) list element \\((N_k \\times P)\\) matrix atoms. marginals marginal distribution empirical measures; NULL (default), uniform weights set measures. Otherwise, length-\\(K\\) list element length-\\(N_i\\) vector nonnegative weights sum 1. weights weights individual measure; NULL (default), measure considered equally. Otherwise, length-\\(K\\) vector. lambda regularization parameter (default: 0.1). p exponent order distance (default: 2). ... extra parameters including abstol stopping criterion iterations (default: 1e-10). init.vec initial vector (default: uniform weight). maxiter maximum number iterations (default: 496). print.progress logical show current iteration (default: FALSE). distances length-\\(K\\) list element \\((N\\times N_k)\\) pairwise distance atoms fixed support given measures.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/fbary15B.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fixed-Support Barycenter by Benamou et al. (2015) — fbary15B","text":"length-\\(N\\) vector probability vector.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/fbary15B.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fixed-Support Barycenter by Benamou et al. (2015) — fbary15B","text":"Benamou J, Carlier G, Cuturi M, Nenna L, Peyré G (2015). “Iterative Bregman Projections Regularized Transportation Problems.” SIAM Journal Scientific Computing, 37(2), A1111-A1138. ISSN 1064-8275, 1095-7197, doi:10.1137/141000439 .","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/fbary15B.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fixed-Support Barycenter by Benamou et al. (2015) — fbary15B","text":"","code":"# \\donttest{ #------------------------------------------------------------------- #     Wasserstein Barycenter for Fixed Atoms with Two Gaussians # # * class 1 : samples from Gaussian with mean=(-4, -4) # * class 2 : samples from Gaussian with mean=(+4, +4) # * target support consists of 7 integer points from -6 to 6, #   where ideally, weight is concentrated near 0 since it's average! #------------------------------------------------------------------- ## GENERATE DATA #  Empirical Measures set.seed(100) ndat = 500 dat1 = matrix(rnorm(ndat*2, mean=-4, sd=0.5),ncol=2) dat2 = matrix(rnorm(ndat*2, mean=+4, sd=0.5),ncol=2)   myatoms = list() myatoms[[1]] = dat1 myatoms[[2]] = dat2 mydata = rbind(dat1, dat2)  #  Fixed Support support = cbind(seq(from=-8,to=8,by=2),                 seq(from=-8,to=8,by=2)) ## COMPUTE comp1 = fbary15B(support, myatoms, lambda=0.5, maxiter=10) comp2 = fbary15B(support, myatoms, lambda=1,   maxiter=10) comp3 = fbary15B(support, myatoms, lambda=10,  maxiter=10)  ## VISUALIZE opar <- par(no.readonly=TRUE) par(mfrow=c(1,3), pty=\"s\") barplot(comp1, ylim=c(0,1), main=\"Probability\\n (lambda=0.5)\") barplot(comp2, ylim=c(0,1), main=\"Probability\\n (lambda=1)\") barplot(comp3, ylim=c(0,1), main=\"Probability\\n (lambda=10)\")  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/fiedler.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the fiedler vector of a point cloud — fiedler","title":"Compute the fiedler vector of a point cloud — fiedler","text":"Given point cloud \\(X \\\\mathbf{R}^{N \\times P}\\), function constructs fully connected weighted graph using RBF (Gaussian) kernel bandwidth chosen median heuristic, forms unnormalized graph Laplacian, returns corresponding Fiedler vector, eigenvector associated second smallest eigenvalue Laplacian.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/fiedler.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the fiedler vector of a point cloud — fiedler","text":"","code":"fiedler(X, normalize = TRUE)"},{"path":"https://www.kisungyou.com/T4transport/reference/fiedler.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the fiedler vector of a point cloud — fiedler","text":"X \\((N\\times P)\\) matrix row observations. normalize Logical; TRUE (default), Fiedler vector rescaled lie \\([0,1]\\) subtracting minimum dividing range, mimicking normalization convention corresponding Python implementation. FALSE, raw eigenvector returned.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/fiedler.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the fiedler vector of a point cloud — fiedler","text":"numeric vector length \\(N\\) containing Fiedler values   associated point input point cloud. normalize = TRUE,   entries interval \\([0,1]\\).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/fiedler.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the fiedler vector of a point cloud — fiedler","text":"","code":"#------------------------------------------------------------------- #                           Description # # Use 'iris' dataset to compute fiedler vector.  # The dataset is visualized in R^2 using PCA #------------------------------------------------------------------- # load dataset X = as.matrix(iris[,1:4])  # PCA preprocessing X2d = X%*%eigen(cov(X))$vectors[,1:2]  # compute fiedler vector fied_vec = fiedler(X2d, normalize=TRUE)  # plot  opar <- par(no.readonly=TRUE) plot(X2d, col=rainbow(150)[as.numeric(cut(fied_vec, breaks=150))],       pch=19, xlab=\"PC 1\", ylab=\"PC 2\",      main=\"Fiedler vector on Iris dataset (PCA-reduced)\")  par(opar)"},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbary1d.html","id":null,"dir":"Reference","previous_headings":"","what":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussbary1d","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussbary1d","text":"Given collection Gaussian distributions \\(\\mathcal{N}(\\mu_i, \\sigma_i^2)\\) \\(=1,\\ldots,n\\), compute Wasserstein barycenter order 2. barycenter computation variance components, use fixed-point algorithm Álvarez-Esteban et al. (2016) .","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbary1d.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussbary1d","text":"","code":"gaussbary1d(means, vars, weights = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbary1d.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussbary1d","text":"means length-\\(n\\) vector mean parameters. vars length-\\(n\\) vector variance parameters. weights weight image; NULL (default), uniform weight set. Otherwise, length-\\(n\\) vector nonnegative weights. ... extra parameters including abstol stopping criterion iterations (default: 1e-8). maxiter maximum number iterations (default: 496).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbary1d.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussbary1d","text":"named list containing mean mean estimated barycenter distribution. var variance estimated barycenter distribution.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbary1d.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussbary1d","text":"Álvarez-Esteban PC, del Barrio E, Cuesta-Albertos JA, Matrán C (2016). “Fixed-Point Approach Barycenters Wasserstein Space.” Journal Mathematical Analysis Applications, 441(2), 744–762. ISSN 0022247X, doi:10.1016/j.jmaa.2016.04.045 .","code":""},{"path":[]},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbary1d.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussbary1d","text":"","code":"#---------------------------------------------------------------------- #                         Two Gaussians # # Two Gaussian distributions are parametrized as follows. # Type 1 : (mean, var) = (-4, 1/4) # Type 2 : (mean, var) = (+4, 1/4) #---------------------------------------------------------------------- # GENERATE PARAMETERS par_mean = c(-4, 4) par_vars = c(0.25, 0.25)  # COMPUTE THE BARYCENTER OF EQUAL WEIGHTS gmean = gaussbary1d(par_mean, par_vars)  # QUANTITIES FOR PLOTTING x_grid  = seq(from=-6, to=6, length.out=200) y_dist1 = stats::dnorm(x_grid, mean=-4, sd=0.5) y_dist2 = stats::dnorm(x_grid, mean=+4, sd=0.5) y_gmean = stats::dnorm(x_grid, mean=gmean$mean, sd=sqrt(gmean$var))   # VISUALIZE opar <- par(no.readonly=TRUE) plot(x_grid, y_gmean, lwd=2, col=\"red\", type=\"l\",      main=\"Barycenter\", xlab=\"x\", ylab=\"density\") lines(x_grid, y_dist1) lines(x_grid, y_dist2)  par(opar)"},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbarypd.html","id":null,"dir":"Reference","previous_headings":"","what":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussbarypd","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussbarypd","text":"Given collection \\(n\\)-dimensional Gaussian distributions \\(N(\\mu_i, \\Sigma_i)\\) \\(=1,\\ldots,n\\), compute Wasserstein barycenter order 2. barycenter computation variance components, use fixed-point algorithm Álvarez-Esteban et al. (2016) .","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbarypd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussbarypd","text":"","code":"gaussbarypd(means, vars, weights = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbarypd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussbarypd","text":"means \\((n\\times p)\\) matrix whose rows mean vectors. vars \\((p\\times p\\times n)\\) array slice covariance matrix. weights weight image; NULL (default), uniform weight set. Otherwise, length-\\(n\\) vector nonnegative weights. ... extra parameters including abstol stopping criterion iterations (default: 1e-8). maxiter maximum number iterations (default: 496).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbarypd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussbarypd","text":"named list containing mean length-\\(p\\) vector mean estimated barycenter distribution. var \\((p\\times p)\\) matrix variance estimated barycenter distribution.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbarypd.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussbarypd","text":"Álvarez-Esteban PC, del Barrio E, Cuesta-Albertos JA, Matrán C (2016). “Fixed-Point Approach Barycenters Wasserstein Space.” Journal Mathematical Analysis Applications, 441(2), 744–762. ISSN 0022247X, doi:10.1016/j.jmaa.2016.04.045 .","code":""},{"path":[]},{"path":"https://www.kisungyou.com/T4transport/reference/gaussbarypd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Barycenter of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussbarypd","text":"","code":"# \\donttest{ #---------------------------------------------------------------------- #                         Two Gaussians in R^2 #---------------------------------------------------------------------- # GENERATE PARAMETERS # means par_mean = rbind(c(-4,0), c(4,0))  # covariances par_vars = array(0,c(2,2,2)) par_vars[,,1] = cbind(c(4,-2),c(-2,4)) par_vars[,,2] = cbind(c(4,+2),c(+2,4))  # COMPUTE THE BARYCENTER OF EQUAL WEIGHTS gmean = gaussbarypd(par_mean, par_vars)  # GET COORDINATES FOR DRAWING pt_type1 = gaussvis2d(par_mean[1,], par_vars[,,1]) pt_type2 = gaussvis2d(par_mean[2,], par_vars[,,2]) pt_gmean = gaussvis2d(gmean$mean, gmean$var)  # VISUALIZE opar <- par(no.readonly=TRUE) plot(pt_gmean, lwd=2, col=\"red\", type=\"l\",      main=\"Barycenter\", xlab=\"\", ylab=\"\",       xlim=c(-6,6)) lines(pt_type1) lines(pt_type2)  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmed1d.html","id":null,"dir":"Reference","previous_headings":"","what":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussmed1d","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussmed1d","text":"Given collection Gaussian distributions \\(\\mathcal{N}(\\mu_i, \\sigma_i^2)\\) \\(=1,\\ldots,n\\), compute Wasserstein median.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmed1d.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussmed1d","text":"","code":"gaussmed1d(means, vars, weights = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmed1d.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussmed1d","text":"means length-\\(n\\) vector mean parameters. vars length-\\(n\\) vector variance parameters. weights weight image; NULL (default), uniform weight set. Otherwise, length-\\(n\\) vector nonnegative weights. ... extra parameters including abstol stopping criterion iterations (default: 1e-8). maxiter maximum number iterations (default: 496).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmed1d.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussmed1d","text":"named list containing mean mean estimated median distribution. var variance estimated median distribution.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmed1d.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussmed1d","text":"K, Shung D, Giuffrè M (2025). “Wasserstein Median Probability Measures.” Journal Computational Graphical Statistics, 34(1), 253-266. ISSN 1061-8600, 1537-2715.","code":""},{"path":[]},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmed1d.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}\\) — gaussmed1d","text":"","code":"# \\donttest{ #---------------------------------------------------------------------- #                         Tree Gaussians # # Three Gaussian distributions are parametrized as follows. # Type 1 : (mean, sd) = (-4, 1) # Type 2 : (mean, sd) = ( 0, 1/5) # Type 3 : (mean, sd) = (+6, 1/2) #---------------------------------------------------------------------- # GENERATE PARAMETERS par_mean = c(-4, 0, +6) par_vars = c(1, 0.04, 0.25)  # COMPUTE THE WASSERSTEIN MEDIAN gmeds = gaussmed1d(par_mean, par_vars)  # COMPUTE THE BARYCENTER  gmean = gaussbary1d(par_mean, par_vars)  # QUANTITIES FOR PLOTTING x_grid  = seq(from=-6, to=8, length.out=1000) y_dist1 = stats::dnorm(x_grid, mean=par_mean[1], sd=sqrt(par_vars[1])) y_dist2 = stats::dnorm(x_grid, mean=par_mean[2], sd=sqrt(par_vars[2])) y_dist3 = stats::dnorm(x_grid, mean=par_mean[3], sd=sqrt(par_vars[3]))  y_gmean = stats::dnorm(x_grid, mean=gmean$mean, sd=sqrt(gmean$var))  y_gmeds = stats::dnorm(x_grid, mean=gmeds$mean, sd=sqrt(gmeds$var))  # VISUALIZE opar <- par(no.readonly=TRUE) plot(x_grid, y_gmeds, lwd=3, col=\"red\", type=\"l\",      main=\"Three Gaussians\", xlab=\"x\", ylab=\"density\",       xlim=range(x_grid), ylim=c(0,2.5)) lines(x_grid, y_gmean, lwd=3, col=\"blue\") lines(x_grid, y_dist1, lwd=1.5, lty=2) lines(x_grid, y_dist2, lwd=1.5, lty=2) lines(x_grid, y_dist3, lwd=1.5, lty=2) legend(\"topleft\", legend=c(\"Median\",\"Barycenter\"),        col=c(\"red\",\"blue\"), lwd=c(3,3), lty=c(1,2))  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmedpd.html","id":null,"dir":"Reference","previous_headings":"","what":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussmedpd","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussmedpd","text":"Given collection \\(p\\)-dimensional Gaussian distributions \\(N(\\mu_i, \\Sigma_i)\\) \\(=1,\\ldots,n\\), compute Wasserstein median.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmedpd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussmedpd","text":"","code":"gaussmedpd(means, vars, weights = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmedpd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussmedpd","text":"means \\((n\\times p)\\) matrix whose rows mean vectors. vars \\((p\\times p\\times n)\\) array slice covariance matrix. weights weight image; NULL (default), uniform weight set. Otherwise, length-\\(n\\) vector nonnegative weights. ... extra parameters including abstol stopping criterion iterations (default: 1e-8). maxiter maximum number iterations (default: 496).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmedpd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussmedpd","text":"named list containing mean length-\\(p\\) vector mean estimated median distribution. var \\((p\\times p)\\) matrix variance estimated median distribution.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmedpd.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussmedpd","text":"K, Shung D, Giuffrè M (2025). “Wasserstein Median Probability Measures.” Journal Computational Graphical Statistics, 34(1), 253-266. ISSN 1061-8600, 1537-2715.","code":""},{"path":[]},{"path":"https://www.kisungyou.com/T4transport/reference/gaussmedpd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wasserstein Median of Gaussian Distributions in \\(\\mathbb{R}^p\\) — gaussmedpd","text":"","code":"# \\donttest{ #---------------------------------------------------------------------- #                         Three Gaussians in R^2 #---------------------------------------------------------------------- # GENERATE PARAMETERS # means par_mean = rbind(c(-4,0), c(0,0), c(5,-1))  # covariances par_vars = array(0,c(2,2,3)) par_vars[,,1] = cbind(c(2,-1),c(-1,2)) par_vars[,,2] = cbind(c(4,+1),c(+1,4)) par_vars[,,3] = diag(c(4,1))  # COMPUTE THE MEDIAN gmeds = gaussmedpd(par_mean, par_vars)  # COMPUTE THE BARYCENTER  gmean = gaussbarypd(par_mean, par_vars)  # GET COORDINATES FOR DRAWING pt_type1 = gaussvis2d(par_mean[1,], par_vars[,,1]) pt_type2 = gaussvis2d(par_mean[2,], par_vars[,,2]) pt_type3 = gaussvis2d(par_mean[3,], par_vars[,,3]) pt_gmean = gaussvis2d(gmean$mean, gmean$var) pt_gmeds = gaussvis2d(gmeds$mean, gmeds$var)  # VISUALIZE opar <- par(no.readonly=TRUE) plot(pt_gmean, lwd=2, col=\"red\", type=\"l\",      main=\"Three Gaussians\", xlab=\"\", ylab=\"\",       xlim=c(-6,8), ylim=c(-2.5,2.5)) lines(pt_gmeds, lwd=2, col=\"blue\") lines(pt_type1, lty=2, lwd=5) lines(pt_type2, lty=2, lwd=5) lines(pt_type3, lty=2, lwd=5) abline(h=0, col=\"grey80\", lty=3) abline(v=0, col=\"grey80\", lty=3) legend(\"topright\", legend=c(\"Median\",\"Barycenter\"),        lwd=2, lty=1, col=c(\"blue\",\"red\"))  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/gaussvis2d.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling from a Bivariate Gaussian Distribution for Visualization — gaussvis2d","title":"Sampling from a Bivariate Gaussian Distribution for Visualization — gaussvis2d","text":"function samples points along contour ellipse represented mean variance parameters 2-dimensional Gaussian distribution help ease manipulating visualization specified distribution. example, can directly use basic plot() function directly drawing.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussvis2d.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling from a Bivariate Gaussian Distribution for Visualization — gaussvis2d","text":"","code":"gaussvis2d(mean, var, n = 500)"},{"path":"https://www.kisungyou.com/T4transport/reference/gaussvis2d.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling from a Bivariate Gaussian Distribution for Visualization — gaussvis2d","text":"mean length-\\(2\\) vector mean parameter. var \\((2\\times 2)\\) matrix covariance parameter. n number points drawn (default: 500).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussvis2d.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling from a Bivariate Gaussian Distribution for Visualization — gaussvis2d","text":"\\((n\\times 2)\\) matrix.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gaussvis2d.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sampling from a Bivariate Gaussian Distribution for Visualization — gaussvis2d","text":"","code":"# \\donttest{ #---------------------------------------------------------------------- #                        Three Gaussians in R^2 #---------------------------------------------------------------------- # MEAN PARAMETERS loc1 = c(-3,0) loc2 = c(0,5) loc3 = c(3,0)  # COVARIANCE PARAMETERS var1 = cbind(c(4,-2),c(-2,4)) var2 = diag(c(9,1)) var3 = cbind(c(4,2),c(2,4))  # GENERATE POINTS visA = gaussvis2d(loc1, var1) visB = gaussvis2d(loc2, var2) visC = gaussvis2d(loc3, var3)  # VISUALIZE opar <- par(no.readonly=TRUE) plot(visA[,1], visA[,2], type=\"l\", xlim=c(-5,5), ylim=c(-2,9),      lwd=3, col=\"red\", main=\"3 Gaussian Distributions\") lines(visB[,1], visB[,2], lwd=3, col=\"blue\") lines(visC[,1], visC[,2], lwd=3, col=\"orange\") legend(\"top\", legend=c(\"Type 1\",\"Type 2\",\"Type 3\"),        lwd=3, col=c(\"red\",\"blue\",\"orange\"), horiz=TRUE)  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/gwbary.html","id":null,"dir":"Reference","previous_headings":"","what":"Gromov-Wasserstein Barycenter — gwbary","title":"Gromov-Wasserstein Barycenter — gwbary","text":"Computes Gromov–Wasserstein (GW) barycenter collection metric measure spaces. Given list distance matrices \\({D^{(k)}}{k=1}^K\\) corresponding marginal distributions, function estimates synthetic metric space whose intrinsic geometry best represents input collection GW criterion. GW barycenter defined minimizer multi-measure Gromov–Wasserstein objective, dataset contributes according user-specified barycentric weight. Since problem jointly non-convex barycenter metric coupling matrices, algorithm proceeds outer–inner iterative procedure.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gwbary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gromov-Wasserstein Barycenter — gwbary","text":"","code":"gwbary(distances, marginals = NULL, weights = NULL, num_support = 100, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/gwbary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gromov-Wasserstein Barycenter — gwbary","text":"distances length-\\(K\\) list element either \\((N_k \\times N_k)\\) distance matrix object class dist representing pairwise distances empirical measure. marginals marginal distributions empirical measures; NULL (default), uniform weights set measures. Otherwise, length-\\(K\\) list element length-\\(N_k\\) vector nonnegative weights sum 1. weights weights individual measure; NULL (default), measure considered equally. Otherwise, length-\\(K\\) vector. num_support number support points \\(M\\) barycenter (default: 100). ... extra parameters including maxiter maximum number iterations (default: 10). abstol stopping criterion iterations (default: 1e-6). method optimization method use; can one \"mm\", \"pg\", \"fw\" (default).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gwbary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gromov-Wasserstein Barycenter — gwbary","text":"named list containing dist object class dist representing GW barycenter. weight length-\\(M\\) vector barycenter weights entries \\(1/M\\).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gwbary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gromov-Wasserstein Barycenter — gwbary","text":"","code":"if (FALSE) { # \\dontrun{ #------------------------------------------------------------------- #                           Description # # GW barycenter computation is quite expensive. In this example,  # we draw a small set of empirical measures from the digit '3' # images and compute their GW barycenter with a small number of  # support points. The attained barycenter distance matrix is then  # passed onto the classical MDS algorithm for visualization. #------------------------------------------------------------------- ## GENERATE DATA data(digits) data_D = vector(\"list\", length=5) data_W = vector(\"list\", length=5) for (i in 1:5){   img_now = img2measure(digits3[[i]])   data_D[[i]] = stats::dist(img_now$support)   data_W[[i]] = as.vector(img_now$weight) }  ## COMPUTE bary_dist <- gwbary(data_D, marginals=data_W, num_support=100) bary_cmd2 <- stats::cmdscale(bary_dist$dist, k=2)  ## VISUALIZE opar <- par(no.readonly=TRUE) par(pty=\"s\") plot(bary_cmd2, main=\"GW Barycenter Embedding\",      xaxt=\"n\", yaxt=\"n\", pch=19, xlab=\"\", ylab=\"\") par(opar) } # }"},{"path":"https://www.kisungyou.com/T4transport/reference/gwdist.html","id":null,"dir":"Reference","previous_headings":"","what":"Gromov-Wasserstein Distance — gwdist","title":"Gromov-Wasserstein Distance — gwdist","text":"Computes Gromov-Wasserstein (GW) distance two metric measure spaces. Given two distance matrices \\(D_X\\) \\(D_Y\\) along respective marginal distributions, function solves GW optimization problem obtain distance value associated optimal transport plan. GW distance provides way compare datasets may lie ambient space focusing intrinsic geometric structure encoded pairwise distances. implementation supports multiple optimization schemes, including majorization–minimization (MM), proximal gradient (PG), Frank–Wolfe (FW).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gwdist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gromov-Wasserstein Distance — gwdist","text":"","code":"gwdist(Dx, Dy, wx = NULL, wy = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/gwdist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gromov-Wasserstein Distance — gwdist","text":"Dx \\((M\\times M)\\) distance matrix dist object compatible size. Dy \\((N\\times N)\\) distance matrix dist object compatible size. wx length-\\(M\\) marginal density sums \\(1\\). NULL (default), uniform weight set. wy length-\\(N\\) marginal density sums \\(1\\). NULL (default), uniform weight set. ... extra parameters including maxiter maximum number iterations (default: 10). abstol stopping criterion iterations (default: 1e-6). method optimization method use; can one \"mm\", \"pg\", \"fw\" (default).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gwdist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gromov-Wasserstein Distance — gwdist","text":"named list containing distance computed GW distance value. plan \\((M\\times N)\\) nonnegative matrix optimal transport plan.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gwdist.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Gromov-Wasserstein Distance — gwdist","text":"Mémoli F (2011). “Gromov–Wasserstein Distances Metric Approach Object Matching.” Foundations Computational Mathematics, 11(4), 417–487. ISSN 1615-3375, 1615-3383.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/gwdist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gromov-Wasserstein Distance — gwdist","text":"","code":"if (FALSE) { # \\dontrun{ #------------------------------------------------------------------- #                           Description # # * class 1 : iris dataset (columns 1-4) with perturbations # * class 2 : class 1 rotated randomly in R^4 # * class 3 : samples from N((0,0), I) # #  We draw 10 empirical measures from each and compare  #  the regular Wasserstein and GW distance. It is expected that  #  the GW distance between class 1 and class 2 is negligible,  #  while the regular Wasserstein distance is large. For simplicity,  #  limit the cardinalities to 20. #------------------------------------------------------------------- ## GENERATE DATA set.seed(10)  #  prepare empty lists inputs = vector(\"list\", length=30)  #  generate class 1 and 2 iris_mat = as.matrix(iris[sample(1:150,20),1:4]) for (i in 1:10){   inputs[[i]] = iris_mat + matrix(rnorm(20*4), ncol=4)   inputs[[i+10]] = inputs[[i]]%*%qr.Q(qr(matrix(runif(16), ncol=4))) } #  generate class 3 for (j in 21:30){   inputs[[j]] = matrix(rnorm(20*4), ncol=4) }  ## COMPUTE #  empty arrays dist_RW = array(0, c(30, 30)) dist_GW = array(0, c(30, 30))  #  compute pairwise distances for (i in 1:29){   X <- inputs[[i]]   Dx <- stats::dist(X)   for (j in (i+1):30){   Y <- inputs[[j]]   Dy <- stats::dist(Y)   dist_RW[i,j] <- dist_RW[j,i] <- wasserstein(X, Y)$distance   dist_GW[i,j] <- dist_GW[j,i] <- gwdist(Dx, Dy)$distance   } }  ## VISUALIZE opar <- par(no.readonly=TRUE) par(mfrow=c(1,2), pty=\"s\") image(dist_RW, xaxt=\"n\", yaxt=\"n\", main=\"Regular Wasserstein distance\") image(dist_GW, xaxt=\"n\", yaxt=\"n\", main=\"Gromov-Wasserstein distance\") par(opar) } # }"},{"path":"https://www.kisungyou.com/T4transport/reference/hdist.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance between Histograms — hdist","title":"Distance between Histograms — hdist","text":"Compute \\(p\\)-Wasserstein distance two 1D histograms share binning, .e., breaks. histograms treated discrete probability measures supported bin midpoints masses given normalized counts. Uses exact 1D monotone OT algorithm, LP entropic regularization.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/hdist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance between Histograms — hdist","text":"","code":"hdist(hist1, hist2, p = 2)"},{"path":"https://www.kisungyou.com/T4transport/reference/hdist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance between Histograms — hdist","text":"hist1 histogram object (class \"histogram\"). hist2 histogram object (class \"histogram\") breaks hist1. p exponent order distance (default: 2).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/hdist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distance between Histograms — hdist","text":"named list containing distance \\(\\mathcal{W}_p\\) distance value.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/hdist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Distance between Histograms — hdist","text":"","code":"# \\donttest{ #---------------------------------------------------------------------- #                      Binned from Gaussian and Uniform # # Create two types of histograms with the same binning. One is from  # the standard normal and the other from uniform distribution in [-5,5]. #---------------------------------------------------------------------- # GENERATE 20 HISTOGRAMS set.seed(100) hist20 = list() bk = seq(from=-10, to=10, length.out=20) # common breaks for (i in 1:10){   hist20[[i]] = hist(stats::rnorm(100), breaks=bk, plot=FALSE)   hist20[[i+10]] = hist(stats::runif(100, min=-5, max=5), breaks=bk, plot=FALSE) }  # COMPUTE THE PAIRWISE DISTANCE pdmat = array(0,c(20,20)) for (i in 1:19){   for (j in (i+1):20){     pdmat[i,j] = hdist(hist20[[i]], hist20[[j]], p=2)$distance     pdmat[j,i] = pdmat[i,j]   } }  # VISUALIZE opar <- par(no.readonly=TRUE) par(pty=\"s\") image(pdmat, axes=FALSE, main=\"Pairwise 2-Wasserstein Distance between Histograms\")  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/histbary.html","id":null,"dir":"Reference","previous_headings":"","what":"Barycenter of Histograms — histbary","title":"Barycenter of Histograms — histbary","text":"Given multiple histograms represented \"histogram\" S3 objects, compute 2-Wasserstein barycenter using exact 1D quantile characterization. input histograms must identical breaks.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histbary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Barycenter of Histograms — histbary","text":"","code":"histbary(hists, weights = NULL, L = 2000L)"},{"path":"https://www.kisungyou.com/T4transport/reference/histbary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Barycenter of Histograms — histbary","text":"hists length-\\(N\\) list histograms (\"histogram\" objects) breaks. weights weight histogram; NULL (default), uniform weights used. Otherwise, length-\\(N\\) vector nonnegative weights. L number quantile levels used approximate barycenter (default: 2000). Larger L gives accurate approximation increased computational cost.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histbary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Barycenter of Histograms — histbary","text":"\"histogram\" object representing Wasserstein barycenter.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histbary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Barycenter of Histograms — histbary","text":"","code":"# \\donttest{ #---------------------------------------------------------------------- #                      Binned from Two Gaussians # # EXAMPLE : Very Small Example for CRAN; just showing how to use it! #---------------------------------------------------------------------- # GENERATE FROM TWO GAUSSIANS WITH DIFFERENT MEANS set.seed(100) x  = stats::rnorm(1000, mean=-4, sd=0.5) y  = stats::rnorm(1000, mean=+4, sd=0.5) bk = seq(from=-10, to=10, length.out=20)  # HISTOGRAMS WITH COMMON BREAKS histxy = list() histxy[[1]] = hist(x, breaks=bk, plot=FALSE) histxy[[2]] = hist(y, breaks=bk, plot=FALSE)  # COMPUTE hh = histbary(histxy)  # VISUALIZE opar <- par(no.readonly=TRUE) par(mfrow=c(1,2), pty=\"s\") barplot(histxy[[1]]$density, col=rgb(0,0,1,1/4),          ylim=c(0, 0.75), main=\"Two Histograms\") barplot(histxy[[2]]$density, col=rgb(1,0,0,1/4),          ylim=c(0, 0.75), add=TRUE) barplot(hh$density, main=\"Barycenter\",         ylim=c(0, 0.75))  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/histbary14C.html","id":null,"dir":"Reference","previous_headings":"","what":"Barycenter of Histograms by Cuturi and Doucet (2014) — histbary14C","title":"Barycenter of Histograms by Cuturi and Doucet (2014) — histbary14C","text":"Given multiple histograms represented \"histogram\" S3 objects, compute Wasserstein barycenter. need one requirement histograms input list hists must breaks. See example construct histogram predefined breaks/bins.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histbary14C.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Barycenter of Histograms by Cuturi and Doucet (2014) — histbary14C","text":"","code":"histbary14C(hists, p = 2, weights = NULL, lambda = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/histbary14C.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Barycenter of Histograms by Cuturi and Doucet (2014) — histbary14C","text":"hists length-\\(N\\) list histograms (\"histogram\" object) breaks. p exponent order distance (default: 2). weights weight image; NULL (default), uniform weight set. Otherwise, length-\\(N\\) vector nonnegative weights. lambda regularization parameter; NULL (default), paper's suggestion taken, nonnegative real number. ... extra parameters including abstol stopping criterion iterations (default: 1e-8). init.vec initial weight vector (default: uniform weight). maxiter maximum number iterations (default: 496). nthread number threads OpenMP run (default: 1). print.progress logical show current iteration (default: TRUE).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histbary14C.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Barycenter of Histograms by Cuturi and Doucet (2014) — histbary14C","text":"\"histogram\" object representing Wasserstein barycenter.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histbary14C.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Barycenter of Histograms by Cuturi and Doucet (2014) — histbary14C","text":"Cuturi M, Doucet (2014-06-22/2014-06-24). “Fast Computation Wasserstein Barycenters.” Xing EP, Jebara T (eds.), Proceedings 31st International Conference Machine Learning, volume 32 Proceedings Machine Learning Research, 685–693.","code":""},{"path":[]},{"path":"https://www.kisungyou.com/T4transport/reference/histbary14C.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Barycenter of Histograms by Cuturi and Doucet (2014) — histbary14C","text":"","code":"# \\donttest{ #---------------------------------------------------------------------- #                      Binned from Two Gaussians # # EXAMPLE : Very Small Example for CRAN; just showing how to use it! #---------------------------------------------------------------------- # GENERATE FROM TWO GAUSSIANS WITH DIFFERENT MEANS set.seed(100) x  = stats::rnorm(1000, mean=-4, sd=0.5) y  = stats::rnorm(1000, mean=+4, sd=0.5) bk = seq(from=-10, to=10, length.out=20)  # HISTOGRAMS WITH COMMON BREAKS histxy = list() histxy[[1]] = hist(x, breaks=bk, plot=FALSE) histxy[[2]] = hist(y, breaks=bk, plot=FALSE)  # COMPUTE hh = histbary14C(histxy, maxiter=5)  # VISUALIZE opar <- par(no.readonly=TRUE) par(mfrow=c(1,2)) barplot(histxy[[1]]$density, col=rgb(0,0,1,1/4),          ylim=c(0, 0.75), main=\"Two Histograms\") barplot(histxy[[2]]$density, col=rgb(1,0,0,1/4),          ylim=c(0, 0.75), add=TRUE) barplot(hh$density, main=\"Barycenter\",         ylim=c(0, 0.75))  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/histbary15B.html","id":null,"dir":"Reference","previous_headings":"","what":"Barycenter of Histograms by Benamou et al. (2015) — histbary15B","title":"Barycenter of Histograms by Benamou et al. (2015) — histbary15B","text":"Given multiple histograms represented \"histogram\" S3 objects, compute Wasserstein barycenter. need one requirement histograms input list hists must breaks. See example construct histogram predefined breaks/bins.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histbary15B.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Barycenter of Histograms by Benamou et al. (2015) — histbary15B","text":"","code":"histbary15B(hists, p = 2, weights = NULL, lambda = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/histbary15B.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Barycenter of Histograms by Benamou et al. (2015) — histbary15B","text":"hists length-\\(N\\) list histograms (\"histogram\" object) breaks. p exponent order distance (default: 2). weights weight image; NULL (default), uniform weight set. Otherwise, length-\\(N\\) vector nonnegative weights. lambda regularization parameter; NULL (default), paper's suggestion taken, nonnegative real number. ... extra parameters including abstol stopping criterion iterations (default: 1e-8). init.vec initial weight vector (default: uniform weight). maxiter maximum number iterations (default: 496). nthread number threads OpenMP run (default: 1). print.progress logical show current iteration (default: TRUE).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histbary15B.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Barycenter of Histograms by Benamou et al. (2015) — histbary15B","text":"\"histogram\" object barycenter.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histbary15B.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Barycenter of Histograms by Benamou et al. (2015) — histbary15B","text":"Benamou J, Carlier G, Cuturi M, Nenna L, Peyré G (2015). “Iterative Bregman Projections Regularized Transportation Problems.” SIAM Journal Scientific Computing, 37(2), A1111-A1138. ISSN 1064-8275, 1095-7197, doi:10.1137/141000439 .","code":""},{"path":[]},{"path":"https://www.kisungyou.com/T4transport/reference/histbary15B.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Barycenter of Histograms by Benamou et al. (2015) — histbary15B","text":"","code":"#---------------------------------------------------------------------- #                      Binned from Two Gaussians # # EXAMPLE : Very Small Example for CRAN; just showing how to use it! #---------------------------------------------------------------------- # GENERATE FROM TWO GAUSSIANS WITH DIFFERENT MEANS set.seed(100) x  = stats::rnorm(1000, mean=-4, sd=0.5) y  = stats::rnorm(1000, mean=+4, sd=0.5) bk = seq(from=-10, to=10, length.out=20)  # HISTOGRAMS WITH COMMON BREAKS histxy = list() histxy[[1]] = hist(x, breaks=bk, plot=FALSE) histxy[[2]] = hist(y, breaks=bk, plot=FALSE)  # COMPUTE hh = histbary15B(histxy, maxiter=5)  # VISUALIZE opar <- par(no.readonly=TRUE) par(mfrow=c(1,2)) barplot(histxy[[1]]$density, col=rgb(0,0,1,1/4),          ylim=c(0, 0.75), main=\"Two Histograms\") barplot(histxy[[2]]$density, col=rgb(1,0,0,1/4),          ylim=c(0, 0.75), add=TRUE) barplot(hh$density, main=\"Barycenter\",         ylim=c(0, 0.75))  par(opar)"},{"path":"https://www.kisungyou.com/T4transport/reference/histdist.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance between Histograms — histdist","title":"Distance between Histograms — histdist","text":"Compute \\(p\\)-Wasserstein distance two 1D histograms share binning, .e., breaks. histograms treated discrete probability measures supported bin midpoints masses given normalized counts. Uses exact 1D monotone OT algorithm, LP entropic regularization.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histdist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance between Histograms — histdist","text":"","code":"histdist(hist1, hist2, p = 2)"},{"path":"https://www.kisungyou.com/T4transport/reference/histdist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance between Histograms — histdist","text":"hist1 histogram object (class \"histogram\"). hist2 histogram object (class \"histogram\") breaks hist1. p exponent order distance (default: 2).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histdist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distance between Histograms — histdist","text":"named list containing distance \\(\\mathcal{W}_p\\) distance value.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histdist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Distance between Histograms — histdist","text":"","code":"# \\donttest{ #---------------------------------------------------------------------- #                      Binned from Gaussian and Uniform # # Create two types of histograms with the same binning. One is from  # the standard normal and the other from uniform distribution in [-5,5]. #---------------------------------------------------------------------- # GENERATE 20 HISTOGRAMS set.seed(100) hist20 = list() bk = seq(from=-10, to=10, length.out=20) # common breaks for (i in 1:10){   hist20[[i]] = hist(stats::rnorm(100), breaks=bk, plot=FALSE)   hist20[[i+10]] = hist(stats::runif(100, min=-5, max=5), breaks=bk, plot=FALSE) }  # COMPUTE THE PAIRWISE DISTANCE pdmat = array(0,c(20,20)) for (i in 1:19){   for (j in (i+1):20){     pdmat[i,j] = histdist(hist20[[i]], hist20[[j]], p=2)$distance     pdmat[j,i] = pdmat[i,j]   } }  # VISUALIZE opar <- par(no.readonly=TRUE) par(pty=\"s\") image(pdmat, axes=FALSE, main=\"Pairwise 2-Wasserstein Distance between Histograms\")  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/histinterp.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolation between Histograms — histinterp","title":"Interpolation between Histograms — histinterp","text":"Given two histograms represented \"histogram\" S3 objects identical breaks, compute interpolated histograms along 2-Wasserstein geodesic connecting . 1D, achieved linear interpolation quantile functions (displacement interpolation).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histinterp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolation between Histograms — histinterp","text":"","code":"histinterp(hist1, hist2, t = 0.5, L = 2000L)"},{"path":"https://www.kisungyou.com/T4transport/reference/histinterp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolation between Histograms — histinterp","text":"hist1 histogram (\"histogram\" object). hist2 another histogram breaks hist1. t scalar numeric vector \\([0,1]\\) specifying interpolation times. t = 0 returns hist1, t = 1 returns hist2. L number quantile levels used approximate geodesic (default: 2000). Larger L gives accurate approximation increased computational cost.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histinterp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolation between Histograms — histinterp","text":"length(t) == 1, single \"histogram\" object representing interpolated distribution time t. length(t) > 1, length-length(t) list \"histogram\" objects.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histinterp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Interpolation between Histograms — histinterp","text":"","code":"# \\donttest{ #---------------------------------------------------------------------- #                      Interpolating Two Gaussians # # The source histogram is created from N(-5,1/4). # The target histogram is created from N(+5,4) #---------------------------------------------------------------------- # SETTING set.seed(123) x_source = rnorm(1000, mean=-5, sd=1/2) x_target = rnorm(1000, mean=+5, sd=2)  # BUILD HISTOGRAMS WITH COMMON BREAKS bk = seq(from=-8, to=12, by=2) h1 = hist(x_source, breaks=bk, plot=FALSE) h2 = hist(x_target, breaks=bk, plot=FALSE)  # INTERPOLATE WITH 5 GRID POINTS h_path <- histinterp(h1, h2, t = seq(0, 1, length.out = 8))  # VISUALIZE y_slim <- c(0, max(h1$density, h2$density)) # shared y-limit xt     <- round(h1$mids, 1) # x-ticks  opar <- par(no.readonly = TRUE) par(mfrow = c(2,4), pty = \"s\") for (i in 1:8){   if (i < 2){     barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim,             main=\"Source\", col=rgb(0,0,1,1/4))   } else if (i > 7){     barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim,             main=\"Target\", col=rgb(1,0,0,1/4))   } else {     barplot(h_path[[i]]$density,  names.arg=xt, ylim=y_slim,              col=\"gray90\", main=sprintf(\"t = %.3f\", (i-1)/7))   } }  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/histmed.html","id":null,"dir":"Reference","previous_headings":"","what":"Wasserstein Median of Histograms — histmed","title":"Wasserstein Median of Histograms — histmed","text":"Given multiple histograms represented \"histogram\" S3 objects common breaks, compute Fréchet (geometric) median 2-Wasserstein distance. 1D, implemented mapping histograms quantile functions running Weiszfeld-type algorithm geometric median Hilbert space quantile functions.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histmed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wasserstein Median of Histograms — histmed","text":"","code":"histmed(hists, weights = NULL, L = 2000L, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/histmed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wasserstein Median of Histograms — histmed","text":"hists length-\\(N\\) list histograms (\"histogram\" objects) identical breaks. weights weight histogram; NULL (default), uniform weights used. Otherwise, length-\\(N\\) vector nonnegative weights. L number quantile levels used approximate median (default: 2000). Larger L gives accurate approximation increased computational cost. ... extra parameters including abstol stopping criterion iterations (default: 1e-8). maxiter maximum number iterations (default: 496). print.progress logical; whether show current iteration        (default: FALSE).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histmed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wasserstein Median of Histograms — histmed","text":"\"histogram\" object representing Wasserstein median.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/histmed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wasserstein Median of Histograms — histmed","text":"","code":"# \\donttest{ #---------------------------------------------------------------------- #                      Binned from Two Gaussians # # Generate 12 histograms from N(-4,1/4) and 8 from N(4,1/4) #---------------------------------------------------------------------- # COMMON SETTING set.seed(100) bk = seq(from=-10, to=10, length.out=20) n_signal = 12  # GENERATE HISTOGRAMS WITH COMMON BREAKS hist_all = list() for (i in 1:n_signal){   hist_all[[i]] = hist(stats::rnorm(200, mean=-4, sd=0.5), breaks=bk) }             for (j in (n_signal+1):20){   hist_all[[j]] = hist(stats::rnorm(200, mean=+4, sd=0.5), breaks=bk) }          # COMPUTE THE BARYCENTER AND THE MEDIAN  h_bary = histbary(hist_all) h_med  = histmed(hist_all)  # VISUALIZE xt   <- round(h_med$mids, 1)  opar <- par(no.readonly=TRUE) par(mfrow=c(1,3), pty=\"s\") barplot(hist_all[[1]]$density, col=rgb(0,0,1,1/4),          ylim=c(0, 0.75), main=\"Two Types\", names.arg=xt) barplot(hist_all[[20]]$density, col=rgb(1,0,0,1/4),          ylim=c(0, 0.75), add=TRUE) barplot(h_med$density,  names.arg=xt, main=\"Median\", ylim=c(0, 0.75)) barplot(h_bary$density, names.arg=xt, main=\"Barycenter\", ylim=c(0, 0.75))  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary14C.html","id":null,"dir":"Reference","previous_headings":"","what":"Barycenter of Images according to Cuturi & Doucet (2014) — imagebary14C","title":"Barycenter of Images according to Cuturi & Doucet (2014) — imagebary14C","text":"Using entropic regularization Wasserstein barycenter computation, imagebary14C finds barycentric image \\(X^*\\) given multiple images \\(X_1,X_2,\\ldots,X_N\\). Please note followings; (1) take matrix image please make grayscale , (2) images size - resizing performed.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary14C.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Barycenter of Images according to Cuturi & Doucet (2014) — imagebary14C","text":"","code":"imagebary14C(images, p = 2, weights = NULL, lambda = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary14C.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Barycenter of Images according to Cuturi & Doucet (2014) — imagebary14C","text":"images length-\\(N\\) list -size image matrices size \\((m\\times n)\\). p exponent order distance (default: 2). weights weight image; NULL (default), uniform weight set. Otherwise, length-\\(N\\) vector nonnegative weights. lambda regularization parameter; NULL (default), paper's suggestion taken, nonnegative real number. ... extra parameters including abstol stopping criterion iterations (default: 1e-8). init.image initial weight image (default: uniform weight). maxiter maximum number iterations (default: 496). nthread number threads OpenMP run (default: 1). print.progress logical show current iteration (default: TRUE).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary14C.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Barycenter of Images according to Cuturi & Doucet (2014) — imagebary14C","text":"\\((m\\times n)\\) matrix barycentric image.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary14C.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Barycenter of Images according to Cuturi & Doucet (2014) — imagebary14C","text":"Cuturi M, Doucet (2014-06-22/2014-06-24). “Fast Computation Wasserstein Barycenters.” Xing EP, Jebara T (eds.), Proceedings 31st International Conference Machine Learning, volume 32 Proceedings Machine Learning Research, 685–693.","code":""},{"path":[]},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary14C.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Barycenter of Images according to Cuturi & Doucet (2014) — imagebary14C","text":"","code":"if (FALSE) { # \\dontrun{ #---------------------------------------------------------------------- #                       MNIST Data with Digit 3 # # EXAMPLE 1 : Very Small  Example for CRAN; just showing how to use it! # EXAMPLE 2 : Medium-size Example for Evolution of Output #---------------------------------------------------------------------- # EXAMPLE 1 data(digit3) datsmall = digit3[1:2] outsmall = imagebary14C(datsmall, maxiter=3)  # EXAMPLE 2 : Barycenter of 100 Images # RANDOMLY SELECT THE IMAGES data(digit3) dat2 = digit3[sample(1:2000, 100)]  # select 100 images  # RUN SEQUENTIALLY run10 = imagebary14C(dat2, maxiter=10)                   # first 10 iterations run20 = imagebary14C(dat2, maxiter=10, init.image=run10) # run 40 more run50 = imagebary14C(dat2, maxiter=30, init.image=run20) # run 50 more  # VISUALIZE opar <- par(no.readonly=TRUE) par(mfrow=c(2,3), pty=\"s\") image(dat2[[sample(100,1)]], axes=FALSE, main=\"a random image\") image(dat2[[sample(100,1)]], axes=FALSE, main=\"a random image\") image(dat2[[sample(100,1)]], axes=FALSE, main=\"a random image\") image(run10, axes=FALSE, main=\"barycenter after 10 iter\") image(run20, axes=FALSE, main=\"barycenter after 20 iter\") image(run50, axes=FALSE, main=\"barycenter after 50 iter\") par(opar) } # }"},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary15B.html","id":null,"dir":"Reference","previous_headings":"","what":"Barycenter of Images according to Benamou et al. (2015) — imagebary15B","title":"Barycenter of Images according to Benamou et al. (2015) — imagebary15B","text":"Using entropic regularization Wasserstein barycenter computation, imagebary15B finds barycentric image \\(X^*\\) given multiple images \\(X_1,X_2,\\ldots,X_N\\). Please note followings; (1) take matrix image please make grayscale , (2) images size - resizing performed.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary15B.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Barycenter of Images according to Benamou et al. (2015) — imagebary15B","text":"","code":"imagebary15B(images, p = 2, weights = NULL, lambda = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary15B.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Barycenter of Images according to Benamou et al. (2015) — imagebary15B","text":"images length-\\(N\\) list -size image matrices size \\((m\\times n)\\). p exponent order distance (default: 2). weights weight image; NULL (default), uniform weight set. Otherwise, length-\\(N\\) vector nonnegative weights. lambda regularization parameter; NULL (default), paper's suggestion taken, nonnegative real number. ... extra parameters including abstol stopping criterion iterations (default: 1e-8). init.image initial weight image (default: uniform weight). maxiter maximum number iterations (default: 496). nthread number threads OpenMP run (default: 1). print.progress logical show current iteration (default: TRUE).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary15B.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Barycenter of Images according to Benamou et al. (2015) — imagebary15B","text":"\\((m\\times n)\\) matrix barycentric image.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary15B.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Barycenter of Images according to Benamou et al. (2015) — imagebary15B","text":"Benamou J, Carlier G, Cuturi M, Nenna L, Peyré G (2015). “Iterative Bregman Projections Regularized Transportation Problems.” SIAM Journal Scientific Computing, 37(2), A1111-A1138. ISSN 1064-8275, 1095-7197, doi:10.1137/141000439 .","code":""},{"path":[]},{"path":"https://www.kisungyou.com/T4transport/reference/imagebary15B.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Barycenter of Images according to Benamou et al. (2015) — imagebary15B","text":"","code":"#---------------------------------------------------------------------- #                       MNIST Data with Digit 3 # # EXAMPLE 1 : Very Small  Example for CRAN; just showing how to use it! # EXAMPLE 2 : Medium-size Example for Evolution of Output #---------------------------------------------------------------------- # EXAMPLE 1 data(digit3) datsmall = digit3[1:2] outsmall = imagebary15B(datsmall, maxiter=3)  if (FALSE) { # \\dontrun{ # EXAMPLE 2 : Barycenter of 100 Images # RANDOMLY SELECT THE IMAGES data(digit3) dat2 = digit3[sample(1:2000, 100)]  # select 100 images  # RUN SEQUENTIALLY run05 = imagebary15B(dat2, maxiter=5)                    # first 5 iterations run10 = imagebary15B(dat2, maxiter=5,  init.image=run05) # run 5 more run50 = imagebary15B(dat2, maxiter=40, init.image=run10) # run 40 more  # VISUALIZE opar <- par(no.readonly=TRUE) par(mfrow=c(2,3), pty=\"s\") image(dat2[[sample(100,1)]], axes=FALSE, main=\"a random image\") image(dat2[[sample(100,1)]], axes=FALSE, main=\"a random image\") image(dat2[[sample(100,1)]], axes=FALSE, main=\"a random image\") image(run05, axes=FALSE, main=\"barycenter after 05 iter\") image(run10, axes=FALSE, main=\"barycenter after 10 iter\") image(run50, axes=FALSE, main=\"barycenter after 50 iter\") par(opar) } # }"},{"path":"https://www.kisungyou.com/T4transport/reference/img2measure.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract a discrete measure from a gray-scale image matrix — img2measure","title":"Extract a discrete measure from a gray-scale image matrix — img2measure","text":"function takes gray-scale image represented matrix \\(X\\) converts discrete measure suitable optimal transport computations Lagrangian framework. Pixel intensities normalized sum one, nonzero pixels represented weighted points (support weights).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/img2measure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract a discrete measure from a gray-scale image matrix — img2measure","text":"","code":"img2measure(X, threshold = TRUE)"},{"path":"https://www.kisungyou.com/T4transport/reference/img2measure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract a discrete measure from a gray-scale image matrix — img2measure","text":"X \\((N,2)\\) nonnegative matrix representing gray-scale image, entry corresponds pixel intensity. threshold logical flag indicating whether threshold small weights smaller machine epsilon.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/img2measure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract a discrete measure from a gray-scale image matrix — img2measure","text":"named list containing support \\((M\\times 2)\\) matrix coordinates nonzero pixels, row point \\((x,y)\\). weight length-\\(M\\) vector weights corresponding nonzero pixels, summing \\(1\\).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/img2measure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract a discrete measure from a gray-scale image matrix — img2measure","text":"","code":"# \\donttest{ #------------------------------------------------------------------- #                           Description # # Take a digit image and compare visualization. #------------------------------------------------------------------- # load the data and select the first image data(digit3) img_matrix = digit3[[1]]  # extract a discrete measure img_measure = img2measure(img_matrix, threshold=TRUE) w  <- img_measure$weight w_norm <- w / max(w)          # now runs from 0 to 1 col_scale <- gray(1 - w_norm) # 1 = white, 0 = black  # visualize opar <- par(no.readonly=TRUE) par(mfrow=c(1,2), pty=\"s\") image(img_matrix, xaxt=\"n\", yaxt=\"n\", main=\"Image Matrix\") plot(img_measure$support,       col = col_scale, xlab=\"\", ylab=\"\",      pch = 19, cex = 0.5, xaxt = \"n\", yaxt = \"n\",      main = \"Extracted Discrete Measure\")  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/ipot.html","id":null,"dir":"Reference","previous_headings":"","what":"Wasserstein Distance via Inexact Proximal Point Method — ipot","title":"Wasserstein Distance via Inexact Proximal Point Method — ipot","text":"Inexact Proximal Point Method (IPOT) offers computationally efficient approach approximating Wasserstein distance two empirical measures iteratively solving series regularized optimal transport problems. method replaces entropic regularization used Sinkhorn's algorithm proximal formulation avoids explicit use entropy, thereby mitigating numerical instabilities. Let \\(C := \\|X_m - Y_n\\|^p\\) cost matrix, \\(X_m\\) \\(Y_n\\) support points two discrete distributions \\(\\mu\\) \\(\\nu\\), respectively. IPOT algorithm solves sequence optimization problems: $$   \\Gamma^{(t+1)} = \\arg\\min_{\\Gamma \\\\Pi(\\mu, \\nu)} \\langle \\Gamma, C \\rangle + \\lambda D(\\Gamma \\| \\Gamma^{(t)}), $$ \\(\\lambda > 0\\) proximal regularization parameter \\(D(\\cdot \\| \\cdot)\\) Kullback–Leibler divergence. subproblem solved approximately using fixed number inner iterations, making method inexact. Unlike entropic methods, IPOT require \\(\\lambda \\rightarrow 0\\) convergence unregularized Wasserstein solution. therefore robust numerical precision issues, especially small regularization parameters, provides closer approximation true optimal transport cost fewer artifacts.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/ipot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wasserstein Distance via Inexact Proximal Point Method — ipot","text":"","code":"ipot(X, Y, p = 2, wx = NULL, wy = NULL, lambda = 1, ...)  ipotD(D, p = 2, wx = NULL, wy = NULL, lambda = 1, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/ipot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wasserstein Distance via Inexact Proximal Point Method — ipot","text":"X \\((M\\times P)\\) matrix row observations. Y \\((N\\times P)\\) matrix row observations. p exponent order distance (default: 2). wx length-\\(M\\) marginal density sums \\(1\\). NULL (default), uniform weight set. wy length-\\(N\\) marginal density sums \\(1\\). NULL (default), uniform weight set. lambda regularization parameter (default: 0.1). ... extra parameters including maxiter maximum number iterations (default: 496). abstol stopping criterion iterations (default: 1e-10). L small number inner loop iterations (default: 1). D \\((M\\times N)\\) distance matrix \\(d(x_m, y_n)\\) two sets observations.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/ipot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wasserstein Distance via Inexact Proximal Point Method — ipot","text":"named list containing distance \\(\\mathcal{W}_p\\) distance value plan \\((M\\times N)\\) nonnegative matrix optimal transport plan.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/ipot.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Wasserstein Distance via Inexact Proximal Point Method — ipot","text":"Xie Y, Wang X, Wang R, Zha H (2020-07-22/2020-07-25). “Fast Proximal Point Method Computing Exact Wasserstein Distance.” Adams RP, Gogate V (eds.), Proceedings 35th Uncertainty Artificial Intelligence Conference, volume 115 Proceedings Machine Learning Research, 433–453.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/ipot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wasserstein Distance via Inexact Proximal Point Method — ipot","text":"","code":"# \\donttest{ #------------------------------------------------------------------- #  Wasserstein Distance between Samples from Two Bivariate Normal # # * class 1 : samples from Gaussian with mean=(-1, -1) # * class 2 : samples from Gaussian with mean=(+1, +1) #------------------------------------------------------------------- ## SMALL EXAMPLE set.seed(100) m = 20 n = 30 X = matrix(rnorm(m*2, mean=-1),ncol=2) # m obs. for X Y = matrix(rnorm(n*2, mean=+1),ncol=2) # n obs. for Y  ## COMPARE WITH WASSERSTEIN  outw = wasserstein(X, Y) ipt1 = ipot(X, Y, lambda=1) ipt2 = ipot(X, Y, lambda=10)  ## VISUALIZE : SHOW THE PLAN AND DISTANCE pmw = paste0(\"Exact plan\\n dist=\",round(outw$distance,2)) pm1 = paste0(\"IPOT (lambda=1)\\n dist=\",round(ipt1$distance,2)) pm2 = paste0(\"IPOT (lambda=10)\\n dist=\",round(ipt2$distance,2))  opar <- par(no.readonly=TRUE) par(mfrow=c(1,3), pty=\"s\") image(outw$plan, axes=FALSE, main=pmw) image(ipt1$plan, axes=FALSE, main=pm1) image(ipt2$plan, axes=FALSE, main=pm2)  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/pwbary.html","id":null,"dir":"Reference","previous_headings":"","what":"Procrustes-Wasserstein Barycenter — pwbary","title":"Procrustes-Wasserstein Barycenter — pwbary","text":"collection empirical measures \\(\\lbrace \\mu_k\\rbrace_{k=1}^K\\), function computes Procrustes-Wasserstein (PW) barycenter (Adamo et al. 2025) , accounts measure transport alignment action orthogonal group.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/pwbary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Procrustes-Wasserstein Barycenter — pwbary","text":"","code":"pwbary(atoms, marginals = NULL, weights = NULL, num_support = 100, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/pwbary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Procrustes-Wasserstein Barycenter — pwbary","text":"atoms length-\\(K\\) list element \\((N_k \\times P)\\) matrix atoms. marginals marginal distributions empirical measures; NULL (default), uniform weights set measures. Otherwise, length-\\(K\\) list element length-\\(N_i\\) vector nonnegative weights sum 1. weights weights individual measure; NULL (default), measure considered equally. Otherwise, length-\\(K\\) vector. num_support number support points \\(M\\) PW barycenter (default: 100). ... extra parameters including abstol stopping criterion iterations (default: 1e-6). maxiter maximum number iterations (default: 10).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/pwbary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Procrustes-Wasserstein Barycenter — pwbary","text":"list three elements: support \\((M \\times P)\\) matrix PW barycenter's support points. weight length-\\(M\\) vector median's weights entries \\(1/M\\).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/pwbary.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Procrustes-Wasserstein Barycenter — pwbary","text":"Adamo D, Corneli M, Vuillien M, Vila E (2025). “Depth Look Procrustes-Wasserstein Distance: Properties Barycenters.” Forty-Second International Conference Machine Learning.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/pwbary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Procrustes-Wasserstein Barycenter — pwbary","text":"","code":"if (FALSE) { # \\dontrun{ #------------------------------------------------------------------- #         Free-Support PW Barycenter of Multiple Gaussians # # * class 1 : samples from N((0,0),  diag(c(4,1/4))) # * class 2 : samples from N((10,0), diag(c(1/4,4))) # * class 3 : samples from N((10,0), Id) randomly rotated # #  We draw 10 empirical measures from each and compare  #  their barycenters under the regular and PW geometries. #------------------------------------------------------------------- ## GENERATE DATA set.seed(10)  #  prepare empty lists input_1 = vector(\"list\", length=10L) input_2 = vector(\"list\", length=10L) input_3 = vector(\"list\", length=10L)  #  generate random_rot = qr.Q(qr(matrix(runif(4), ncol=2))) for (i in 1:10){   input_1[[i]] = cbind(rnorm(50, sd=2), rnorm(50, sd=0.5)) } for (j in 1:10){   base_draw = cbind(rnorm(50, sd=0.5), rnorm(50, sd=2))   base_draw[,1] = base_draw[,1] + 10      input_2[[j]] = base_draw   input_3[[j]] = base_draw%*%random_rot }  ## COMPUTE #  regular Wasserstein barycenters regular_1 = rbaryGD(input_1, num_support=50) regular_2 = rbaryGD(input_2, num_support=50) regular_3 = rbaryGD(input_3, num_support=50)  #  Procrustes-Wasserstein barycenters pw_1 = pwbary(input_1, num_support=50) pw_2 = pwbary(input_2, num_support=50) pw_3 = pwbary(input_3, num_support=50)  ## VISUALIZE opar <- par(no.readonly=TRUE) par(mfrow=c(3,1))  #  set the x- and y-limits for display lim_x = c(-12, 12) lim_y = c(-10, 5)  #  plot prototypical measures per class plot(input_1[[1]], pch=19, cex=0.5, col=\"gray80\",       main=\"3 types of measures\", xlab=\"\", ylab=\"\",      xlim=lim_x, ylim=lim_y) points(input_2[[1]], pch=19, cex=0.5, col=\"gray50\") points(input_3[[1]], pch=19, cex=0.5, col=\"gray10\")  #  plot regular barycenters plot(regular_1$support, pch=19, cex=0.5, col=\"blue\",       main=\"Regular Wasserstein barycenters\",      xlab=\"\", ylab=\"\", xlim=lim_x, ylim=lim_y) points(regular_2$support, pch=19, cex=0.5, col=\"cyan\") points(regular_3$support, pch=19, cex=0.5, col=\"red\")  #  plot PW barycenters plot(pw_1$support, pch=19, cex=0.5, col=\"blue\",       main=\"Procrustes-Wasserstein barycenters\",      xlab=\"\", ylab=\"\", xlim=lim_x, ylim=lim_y) points(pw_2$support, pch=19, cex=0.5, col=\"cyan\") points(pw_3$support, pch=19, cex=0.5, col=\"red\") par(opar) } # }"},{"path":"https://www.kisungyou.com/T4transport/reference/pwdist.html","id":null,"dir":"Reference","previous_headings":"","what":"Procrustes-Wasserstein Distance — pwdist","title":"Procrustes-Wasserstein Distance — pwdist","text":"Given two empirical measures $$\\mu = \\sum_{m=1}^M \\mu_m \\delta_{X_m}\\quad\\textrm{}\\quad \\nu = \\sum_{n=1}^N \\nu_n \\delta_{Y_n}$$ \\(\\mathbb{R}^P\\), Procrustes-Wasserstein (PW) distance defined follows: $$   PW_2^2(\\mu, \\nu) = \\min_{Q\\\\mathcal{O}(P)} W_2^2(\\mu, Q_\\# \\nu), $$ \\(\\mathcal{O}(P)\\) orthogonal group \\(Q_\\#\\nu\\) pushforward via \\(Q\\).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/pwdist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Procrustes-Wasserstein Distance — pwdist","text":"","code":"pwdist(X, Y, wx = NULL, wy = NULL, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/pwdist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Procrustes-Wasserstein Distance — pwdist","text":"X \\((M\\times P)\\) matrix row observations. Y \\((N\\times P)\\) matrix row observations. wx length-\\(M\\) marginal density sums \\(1\\). NULL (default), uniform weight set. wy length-\\(N\\) marginal density sums \\(1\\). NULL (default), uniform weight set. ... extra parameters including maxiter maximum number iterations (default: 496). abstol stopping criterion iterations (default: 1e-10).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/pwdist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Procrustes-Wasserstein Distance — pwdist","text":"named list containing distance computed PW distance value. plan \\((M\\times N)\\) nonnegative matrix optimal transport plan. alignment optimal alignment matrix size  \\((P\\times P)\\) \\(\\mathcal{O}(P)\\).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/pwdist.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Procrustes-Wasserstein Distance — pwdist","text":"Adamo D, Corneli M, Vuillien M, Vila E (2025). “Depth Look Procrustes-Wasserstein Distance: Properties Barycenters.” Forty-Second International Conference Machine Learning.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/pwdist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Procrustes-Wasserstein Distance — pwdist","text":"","code":"if (FALSE) { # \\dontrun{ #------------------------------------------------------------------- #                           Description # # * class 1 : samples from N((0,0),  diag(c(4,1/4))) # * class 2 : samples from N((10,0), diag(c(1/4,4))) # * class 3 : samples from N((10,0), diag(c(1/4,4))) randomly rotated # #  We draw 10 empirical measures from each and compare  #  the regular Wasserstein and PW distance. #------------------------------------------------------------------- ## GENERATE DATA set.seed(10)  #  prepare empty lists inputs = vector(\"list\", length=30)  #  generate random_rot = qr.Q(qr(matrix(runif(4), ncol=2))) for (i in 1:10){   inputs[[i]] = matrix(rnorm(50*2), ncol=2) } for (j in 11:20){   base_draw = matrix(rnorm(50*2), ncol=2)   base_draw[,1] = base_draw[,1] + 10      inputs[[j]] = base_draw   inputs[[j+10]] = base_draw%*%random_rot }  ## COMPUTE #  empty arrays dist_RW = array(0, c(30, 30)) dist_PW = array(0, c(30, 30))  #  compute pairwise distances for (i in 1:29){   for (j in (i+1):30){   dist_RW[i,j] <- dist_RW[j,i] <- wasserstein(inputs[[i]], inputs[[j]])$distance   dist_PW[i,j] <- dist_PW[j,i] <- pwdist(inputs[[i]], inputs[[j]])$distance   } }  ## VISUALIZE opar <- par(no.readonly=TRUE) par(mfrow=c(1,2), pty=\"s\") image(dist_RW, xaxt=\"n\", yaxt=\"n\", main=\"Regular Wasserstein distance\") image(dist_PW, xaxt=\"n\", yaxt=\"n\", main=\"PW distance\") par(opar) } # }"},{"path":"https://www.kisungyou.com/T4transport/reference/rbary23L.html","id":null,"dir":"Reference","previous_headings":"","what":"Free-Support Barycenter by von Lindheim (2023) — rbary23L","title":"Free-Support Barycenter by von Lindheim (2023) — rbary23L","text":"collection empirical measures \\(\\lbrace \\mu_k\\rbrace_{k=1}^K\\), function implements free-support barycenter algorithm introduced von Lindheim (2023) . algorithm takes first input marginal reference performs one-step update support. version implements `reference` algorithm \\(p=2\\).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rbary23L.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Free-Support Barycenter by von Lindheim (2023) — rbary23L","text":"","code":"rbary23L(atoms, marginals = NULL, weights = NULL)"},{"path":"https://www.kisungyou.com/T4transport/reference/rbary23L.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Free-Support Barycenter by von Lindheim (2023) — rbary23L","text":"atoms length-\\(K\\) list element \\((N_k \\times P)\\) matrix atoms. marginals marginal distributions empirical measures; NULL (default), uniform weights set measures. Otherwise, length-\\(K\\) list element length-\\(N_i\\) vector nonnegative weights sum 1. weights weights individual measure; NULL (default), measure considered equally. Otherwise, length-\\(K\\) vector.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rbary23L.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Free-Support Barycenter by von Lindheim (2023) — rbary23L","text":"list two elements: support \\((N_1 \\times P)\\) matrix barycenter support points (number atoms first empirical measure). weight length-\\(N_1\\) vector representing barycenter weights (copied first marginal).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rbary23L.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Free-Support Barycenter by von Lindheim (2023) — rbary23L","text":"von Lindheim J (2023). “Simple Approximative Algorithms Free-Support Wasserstein Barycenters.” Computational Optimization Applications, 85(1), 213–246. ISSN 0926-6003, 1573-2894, doi:10.1007/s10589-023-00458-3 .","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rbary23L.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Free-Support Barycenter by von Lindheim (2023) — rbary23L","text":"","code":"# \\donttest{ #------------------------------------------------------------------- #     Free-Support Wasserstein Barycenter of Four Gaussians # # * class 1 : samples from Gaussian with mean=(-4, -4) # * class 2 : samples from Gaussian with mean=(+4, +4) # * class 3 : samples from Gaussian with mean=(+4, -4) # * class 4 : samples from Gaussian with mean=(-4, +4) # #  The barycenter is computed using the first measure as a reference. #  All measures have uniform weights. #  The barycenter function also considers uniform weights. #------------------------------------------------------------------- ## GENERATE DATA #  Empirical Measures set.seed(100) unif4 = round(runif(4, 100, 200)) dat1 = matrix(rnorm(unif4[1]*2, mean=-4, sd=0.5),ncol=2) dat2 = matrix(rnorm(unif4[2]*2, mean=+4, sd=0.5),ncol=2)  dat3 = cbind(rnorm(unif4[3], mean=+4, sd=0.5), rnorm(unif4[3], mean=-4, sd=0.5)) dat4 = cbind(rnorm(unif4[4], mean=-4, sd=0.5), rnorm(unif4[4], mean=+4, sd=0.5))  myatoms = list() myatoms[[1]] = dat1 myatoms[[2]] = dat2 myatoms[[3]] = dat3 myatoms[[4]] = dat4  ## COMPUTE fsbary = rbary23L(myatoms)  ## VISUALIZE #  aligned with CRAN convention opar <- par(no.readonly=TRUE)  #  plot the input measures plot(myatoms[[1]], col=\"gray90\", pch=19, cex=0.5, xlim=c(-6,6), ylim=c(-6,6),       main=\"Input Measures\", xlab=\"Dimension 1\", ylab=\"Dimension 2\") points(myatoms[[2]], col=\"gray90\", pch=19, cex=0.25) points(myatoms[[3]], col=\"gray90\", pch=19, cex=0.25) points(myatoms[[4]], col=\"gray90\", pch=19, cex=0.25)  #  plot the barycenter points(fsbary$support, col=\"red\", cex=0.5, pch=19)  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/rbaryGD.html","id":null,"dir":"Reference","previous_headings":"","what":"Free-Support Barycenter by Riemannian Gradient Descent — rbaryGD","title":"Free-Support Barycenter by Riemannian Gradient Descent — rbaryGD","text":"collection empirical measures \\(\\lbrace \\mu_k\\rbrace_{k=1}^K\\), free-support barycenter order 2, defined minimizer following functional, $$ \\mathcal{F}(\\nu) = \\sum_{k=1}^K w_k \\mathcal{W}_2^2 (\\nu, \\mu_k ), $$ computed using Riemannian gradient descent algorithm. algorithm based formal Riemannian geometric view 2-Wasserstein space according Otto (2001) .","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rbaryGD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Free-Support Barycenter by Riemannian Gradient Descent — rbaryGD","text":"","code":"rbaryGD(atoms, marginals = NULL, weights = NULL, num_support = 100, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/rbaryGD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Free-Support Barycenter by Riemannian Gradient Descent — rbaryGD","text":"atoms length-\\(K\\) list element \\((N_k \\times P)\\) matrix atoms. marginals marginal distributions empirical measures; NULL (default), uniform weights set measures. Otherwise, length-\\(K\\) list element length-\\(N_k\\) vector nonnegative weights sum 1. weights weights individual measure; NULL (default), measure considered equally. Otherwise, length-\\(K\\) vector. num_support number support points \\(M\\) barycenter (default: 100). ... extra parameters including abstol stopping criterion iterations (default: 1e-6). maxiter maximum number iterations (default: 10).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rbaryGD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Free-Support Barycenter by Riemannian Gradient Descent — rbaryGD","text":"list three elements: support \\((M \\times P)\\) matrix barycenter support points. weight length-\\(M\\) vector barycenter weights entries \\(1/M\\). history vector cost values iteration.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rbaryGD.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Free-Support Barycenter by Riemannian Gradient Descent — rbaryGD","text":"Otto F (2001). “Geometry Dissipative Evolution Equations: Porous Medium Equation.” Communications Partial Differential Equations, 26(1-2), 101–174. ISSN 0360-5302, 1532-4133, doi:10.1081/PDE-100002243 .","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rbaryGD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Free-Support Barycenter by Riemannian Gradient Descent — rbaryGD","text":"","code":"# \\donttest{ #------------------------------------------------------------------- #     Free-Support Wasserstein Barycenter of Four Gaussians # # * class 1 : samples from Gaussian with mean=(-4, -4) # * class 2 : samples from Gaussian with mean=(+4, +4) # * class 3 : samples from Gaussian with mean=(+4, -4) # * class 4 : samples from Gaussian with mean=(-4, +4) # #  All measures have uniform weights. #------------------------------------------------------------------- ## GENERATE DATA #  Empirical Measures set.seed(100) unif4 = round(runif(4, 100, 200)) dat1 = matrix(rnorm(unif4[1]*2, mean=-4, sd=0.5),ncol=2) dat2 = matrix(rnorm(unif4[2]*2, mean=+4, sd=0.5),ncol=2)  dat3 = cbind(rnorm(unif4[3], mean=+4, sd=0.5), rnorm(unif4[3], mean=-4, sd=0.5)) dat4 = cbind(rnorm(unif4[4], mean=-4, sd=0.5), rnorm(unif4[4], mean=+4, sd=0.5))  myatoms = list() myatoms[[1]] = dat1 myatoms[[2]] = dat2 myatoms[[3]] = dat3 myatoms[[4]] = dat4  ## COMPUTE fsbary = rbaryGD(myatoms)  ## VISUALIZE #  aligned with CRAN convention opar <- par(no.readonly=TRUE, mfrow=c(1,2))  #  plot the input measures and the barycenter plot(myatoms[[1]], col=\"gray90\", pch=19, cex=0.5, xlim=c(-6,6), ylim=c(-6,6),       main=\"Inputs and Barycenter\", xlab=\"Dimension 1\", ylab=\"Dimension 2\") points(myatoms[[2]], col=\"gray90\", pch=19, cex=0.25) points(myatoms[[3]], col=\"gray90\", pch=19, cex=0.25) points(myatoms[[4]], col=\"gray90\", pch=19, cex=0.25) points(fsbary$support, col=\"red\", cex=0.5, pch=19)  #  plot the cost history with only integer ticks plot(seq_along(fsbary$history), fsbary$history, type=\"b\", lwd=2, pch=19,      main=\"Cost History\", xlab=\"Iteration\", ylab=\"Cost\", xaxt='n') axis(1, at=seq_along(fsbary$history))  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/rmedIRLS.html","id":null,"dir":"Reference","previous_headings":"","what":"Free-Support Median by IRLS — rmedIRLS","title":"Free-Support Median by IRLS — rmedIRLS","text":"collection empirical measures \\(\\lbrace \\mu_k\\rbrace_{k=1}^K\\), free-support Wasserstein median, minimizer following functional $$ \\mathcal{F}(\\nu) = \\sum_{k=1}^K w_k \\mathcal{W}_2 (\\nu, \\mu_k ), $$ computed using generic method iteratively-reweighted least squares (IRLS) method according et al. (2025) .","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rmedIRLS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Free-Support Median by IRLS — rmedIRLS","text":"","code":"rmedIRLS(atoms, marginals = NULL, weights = NULL, num_support = 100, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/rmedIRLS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Free-Support Median by IRLS — rmedIRLS","text":"atoms length-\\(K\\) list element \\((N_k \\times P)\\) matrix atoms. marginals marginal distributions empirical measures; NULL (default), uniform weights set measures. Otherwise, length-\\(K\\) list element length-\\(N_i\\) vector nonnegative weights sum 1. weights weights individual measure; NULL (default), measure considered equally. Otherwise, length-\\(K\\) vector. num_support number support points \\(M\\) barycenter (default: 100). ... extra parameters including abstol stopping criterion iterations (default: 1e-6). maxiter maximum number iterations (default: 10).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rmedIRLS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Free-Support Median by IRLS — rmedIRLS","text":"list three elements: support \\((M \\times P)\\) matrix Wasserstein median's support points. weight length-\\(M\\) vector median's weights entries \\(1/M\\). history vector cost values iteration.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rmedIRLS.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Free-Support Median by IRLS — rmedIRLS","text":"K, Shung D, Giuffrè M (2025). “Wasserstein Median Probability Measures.” Journal Computational Graphical Statistics, 34(1), 253-266. ISSN 1061-8600, 1537-2715.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rmedIRLS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Free-Support Median by IRLS — rmedIRLS","text":"","code":"if (FALSE) { # \\dontrun{ #------------------------------------------------------------------- #     Free-Support Wasserstein Median of Multiple Gaussians # # * class 1 : samples from N((0,0),  Id) # * class 2 : samples from N((20,0), Id) # #  We draw 8 empirical measures of size 50 from class 1, and  #  2 from class 2. All measures have uniform weights. #------------------------------------------------------------------- ## GENERATE DATA #  8 empirical measures from class 1 input_measures = vector(\"list\", length=10L) for (i in 1:8){   input_measures[[i]] = matrix(rnorm(50*2), ncol=2) } for (j in 9:10){   base_draw = matrix(rnorm(50*2), ncol=2)   base_draw[,1] = base_draw[,1] + 20   input_measures[[j]] = base_draw }  ## COMPUTE #  compute the Wasserstein median run_median = rmedIRLS(input_measures, num_support = 50) #  compute the Wasserstein barycenter run_bary   = rbaryGD(input_measures, num_support = 50)  ## VISUALIZE opar <- par(no.readonly=TRUE)  #  draw the base points of two classes base_1 = matrix(rnorm(80*2), ncol=2) base_2 = matrix(rnorm(20*2), ncol=2) base_2[,1] = base_2[,1] + 20 base_mat = rbind(base_1, base_2) plot(base_mat, col=\"gray80\", pch=19)  #  auxiliary information title(\"estimated barycenter and median\") abline(v=0); abline(h=0)  #  draw the barycenter and the median points(run_bary$support, col=\"red\", pch=19) points(run_median$support, col=\"blue\", pch=19) par(opar) } # }"},{"path":"https://www.kisungyou.com/T4transport/reference/rmedPF.html","id":null,"dir":"Reference","previous_headings":"","what":"Free-Support Median by Particle-Flow Algorithm — rmedPF","title":"Free-Support Median by Particle-Flow Algorithm — rmedPF","text":"collection empirical measures \\(\\lbrace \\mu_k\\rbrace_{k=1}^K\\), free-support Wasserstein median, minimizer following functional $$ \\mathcal{F}(\\nu) = \\sum_{k=1}^K w_k \\mathcal{W}_2 (\\nu, \\mu_k ), $$ computed using particle-flow algorithm.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rmedPF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Free-Support Median by Particle-Flow Algorithm — rmedPF","text":"","code":"rmedPF(atoms, marginals = NULL, weights = NULL, num_support = 100, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/rmedPF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Free-Support Median by Particle-Flow Algorithm — rmedPF","text":"atoms length-\\(K\\) list element \\((N_k \\times P)\\) matrix atoms. marginals marginal distributions empirical measures; NULL (default), uniform weights set measures. Otherwise, length-\\(K\\) list element length-\\(N_i\\) vector nonnegative weights sum 1. weights weights individual measure; NULL (default), measure considered equally. Otherwise, length-\\(K\\) vector. num_support number support points \\(M\\) barycenter (default: 100). ... extra parameters including abstol stopping criterion iterations (default: 1e-6). maxiter maximum number iterations (default: 10).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rmedPF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Free-Support Median by Particle-Flow Algorithm — rmedPF","text":"list three elements: support \\((M \\times P)\\) matrix Wasserstein median's support points. weight length-\\(M\\) vector median's weights entries \\(1/M\\). history vector cost values iteration.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rmedPF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Free-Support Median by Particle-Flow Algorithm — rmedPF","text":"","code":"if (FALSE) { # \\dontrun{ #------------------------------------------------------------------- #     Free-Support Wasserstein Median of Multiple Gaussians # # * class 1 : samples from N((0,0),  Id) # * class 2 : samples from N((20,0), Id) # #  We draw 8 empirical measures of size 50 from class 1, and  #  2 from class 2. All measures have uniform weights. #------------------------------------------------------------------- ## GENERATE DATA #  8 empirical measures from class 1 input_measures = vector(\"list\", length=10L) for (i in 1:8){   input_measures[[i]] = matrix(rnorm(50*2), ncol=2) } for (j in 9:10){   base_draw = matrix(rnorm(50*2), ncol=2)   base_draw[,1] = base_draw[,1] + 20   input_measures[[j]] = base_draw }  ## COMPUTE #  compute the Wasserstein median run_median = rmedPF(input_measures, num_support = 50) #  compute the Wasserstein barycenter run_bary   = rbaryGD(input_measures, num_support = 50)  ## VISUALIZE opar <- par(no.readonly=TRUE)  #  draw the base points of two classes base_1 = matrix(rnorm(80*2), ncol=2) base_2 = matrix(rnorm(20*2), ncol=2) base_2[,1] = base_2[,1] + 20 base_mat = rbind(base_1, base_2) plot(base_mat, col=\"gray80\", pch=19)  #  auxiliary information title(\"estimated barycenter and median\") abline(v=0); abline(h=0)  #  draw the barycenter and the median points(run_bary$support, col=\"red\", pch=19) points(run_median$support, col=\"blue\", pch=19) par(opar) } # }"},{"path":"https://www.kisungyou.com/T4transport/reference/rmedWB.html","id":null,"dir":"Reference","previous_headings":"","what":"Free-Support Median by Weiszfeld Update with Barycentric Projection — rmedWB","title":"Free-Support Median by Weiszfeld Update with Barycentric Projection — rmedWB","text":"collection empirical measures \\(\\lbrace \\mu_k\\rbrace_{k=1}^K\\), free-support Wasserstein median, minimizer following functional $$ \\mathcal{F}(\\nu) = \\sum_{k=1}^K w_k \\mathcal{W}_2 (\\nu, \\mu_k ), $$ computed using OT-adapted version Weiszfeld algorithm using barycentric projection means recover optimal displacement map.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rmedWB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Free-Support Median by Weiszfeld Update with Barycentric Projection — rmedWB","text":"","code":"rmedWB(atoms, marginals = NULL, weights = NULL, num_support = 100, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/rmedWB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Free-Support Median by Weiszfeld Update with Barycentric Projection — rmedWB","text":"atoms length-\\(K\\) list element \\((N_k \\times P)\\) matrix atoms. marginals marginal distributions empirical measures; NULL (default), uniform weights set measures. Otherwise, length-\\(K\\) list element length-\\(N_i\\) vector nonnegative weights sum 1. weights weights individual measure; NULL (default), measure considered equally. Otherwise, length-\\(K\\) vector. num_support number support points \\(M\\) barycenter (default: 100). ... extra parameters including abstol stopping criterion iterations (default: 1e-6). maxiter maximum number iterations (default: 10).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rmedWB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Free-Support Median by Weiszfeld Update with Barycentric Projection — rmedWB","text":"list three elements: support \\((M \\times P)\\) matrix Wasserstein median's support points. weight length-\\(M\\) vector median's weights entries \\(1/M\\). history vector cost values iteration.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/rmedWB.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Free-Support Median by Weiszfeld Update with Barycentric Projection — rmedWB","text":"","code":"if (FALSE) { # \\dontrun{ #------------------------------------------------------------------- #     Free-Support Wasserstein Median of Multiple Gaussians # # * class 1 : samples from N((0,0),  Id) # * class 2 : samples from N((20,0), Id) # #  We draw 8 empirical measures of size 50 from class 1, and  #  2 from class 2. All measures have uniform weights. #------------------------------------------------------------------- ## GENERATE DATA #  8 empirical measures from class 1 input_measures = vector(\"list\", length=10L) for (i in 1:8){   input_measures[[i]] = matrix(rnorm(50*2), ncol=2) } for (j in 9:10){   base_draw = matrix(rnorm(50*2), ncol=2)   base_draw[,1] = base_draw[,1] + 20   input_measures[[j]] = base_draw }  ## COMPUTE #  compute the Wasserstein median run_median = rmedWB(input_measures, num_support = 50) #  compute the Wasserstein barycenter run_bary   = rbaryGD(input_measures, num_support = 50)  ## VISUALIZE opar <- par(no.readonly=TRUE)  #  draw the base points of two classes base_1 = matrix(rnorm(80*2), ncol=2) base_2 = matrix(rnorm(20*2), ncol=2) base_2[,1] = base_2[,1] + 20 base_mat = rbind(base_1, base_2) plot(base_mat, col=\"gray80\", pch=19)  #  auxiliary information title(\"estimated barycenter and median\") abline(v=0); abline(h=0)  #  draw the barycenter and the median points(run_bary$support, col=\"red\", pch=19) points(run_median$support, col=\"blue\", pch=19) par(opar) } # }"},{"path":"https://www.kisungyou.com/T4transport/reference/sinkhorn.html","id":null,"dir":"Reference","previous_headings":"","what":"Wasserstein Distance via Entropic Regularization and Sinkhorn Algorithm — sinkhorn","title":"Wasserstein Distance via Entropic Regularization and Sinkhorn Algorithm — sinkhorn","text":"alleviate computational burden solving exact optimal transport problem via linear programming, Cuturi (2013) introduced entropic regularization scheme yields smooth approximation Wasserstein distance. Let \\(C:=\\|X_m - Y_n\\|^p\\) cost matrix, \\(X_m\\) \\(Y_n\\) observations two distributions \\(\\mu\\) \\(nu\\). , regularized problem adds penalty term objective function: $$   W_{p,\\lambda}^p(\\mu, \\nu) = \\min_{\\Gamma \\\\Pi(\\mu, \\nu)} \\langle \\Gamma, C \\rangle + \\lambda \\sum_{m,n} \\Gamma_{m,n} \\log (\\Gamma_{m,n}), $$ \\(\\lambda > 0\\) regularization parameter \\(\\Gamma\\) denotes transport plan. \\(\\lambda \\rightarrow 0\\), regularized solution converges exact Wasserstein solution, small values \\(\\lambda\\) may cause numerical instability due underflow. cases, implementation halts error; users advised increase \\(\\lambda\\) maintain numerical stability.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/sinkhorn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wasserstein Distance via Entropic Regularization and Sinkhorn Algorithm — sinkhorn","text":"","code":"sinkhorn(X, Y, p = 2, wx = NULL, wy = NULL, lambda = 0.1, ...)  sinkhornD(D, p = 2, wx = NULL, wy = NULL, lambda = 0.1, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/sinkhorn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wasserstein Distance via Entropic Regularization and Sinkhorn Algorithm — sinkhorn","text":"X \\((M\\times P)\\) matrix row observations. Y \\((N\\times P)\\) matrix row observations. p exponent order distance (default: 2). wx length-\\(M\\) marginal density sums \\(1\\). NULL (default), uniform weight set. wy length-\\(N\\) marginal density sums \\(1\\). NULL (default), uniform weight set. lambda regularization parameter (default: 0.1). ... extra parameters including maxiter maximum number iterations (default: 496). abstol stopping criterion iterations (default: 1e-10). D \\((M\\times N)\\) distance matrix \\(d(x_m, y_n)\\) two sets observations.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/sinkhorn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wasserstein Distance via Entropic Regularization and Sinkhorn Algorithm — sinkhorn","text":"named list containing distance \\(\\mathcal{W}_p\\) distance value. plan \\((M\\times N)\\) nonnegative matrix optimal transport plan.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/sinkhorn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Wasserstein Distance via Entropic Regularization and Sinkhorn Algorithm — sinkhorn","text":"Cuturi M (2013). “Sinkhorn Distances: Lightspeed Computation Optimal Transport.” Burges CJ, Bottou L, Welling M, Ghahramani Z, Weinberger KQ (eds.), Advances Neural Information Processing Systems, volume 26.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/sinkhorn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wasserstein Distance via Entropic Regularization and Sinkhorn Algorithm — sinkhorn","text":"","code":"# \\donttest{ #------------------------------------------------------------------- #  Wasserstein Distance between Samples from Two Bivariate Normal # # * class 1 : samples from Gaussian with mean=(-1, -1) # * class 2 : samples from Gaussian with mean=(+1, +1) #------------------------------------------------------------------- ## SMALL EXAMPLE set.seed(100) m = 20 n = 10 X = matrix(rnorm(m*2, mean=-1),ncol=2) # m obs. for X Y = matrix(rnorm(n*2, mean=+1),ncol=2) # n obs. for Y  ## COMPARE WITH WASSERSTEIN  outw = wasserstein(X, Y) skh1 = sinkhorn(X, Y, lambda=0.05) skh2 = sinkhorn(X, Y, lambda=0.25)  ## VISUALIZE : SHOW THE PLAN AND DISTANCE pm1 = paste0(\"Exact Wasserstein:\\n distance=\",round(outw$distance,2)) pm2 = paste0(\"Sinkhorn (lbd=0.05):\\n distance=\",round(skh1$distance,2)) pm5 = paste0(\"Sinkhorn (lbd=0.25):\\n distance=\",round(skh2$distance,2))  opar <- par(no.readonly=TRUE) par(mfrow=c(1,3), pty=\"s\") image(outw$plan, axes=FALSE, main=pm1) image(skh1$plan, axes=FALSE, main=pm2) image(skh2$plan, axes=FALSE, main=pm5)  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/swdist.html","id":null,"dir":"Reference","previous_headings":"","what":"Sliced Wasserstein Distance — swdist","title":"Sliced Wasserstein Distance — swdist","text":"Sliced Wasserstein (SW) Distance popular alternative standard Wasserstein distance due computational efficiency top nice theoretical properties. \\(d\\)-dimensional probability measures \\(\\mu\\) \\(\\nu\\), SW distance defined $$\\mathcal{SW}_p (\\mu, \\nu) = \\left( \\int_{\\mathbb{S}^{d-1}} \\mathcal{W}_p^p ( \\langle \\theta, \\mu\\rangle, \\langle \\theta, \\nu \\rangle) d\\lambda (\\theta) \\right)^{1/p},$$ \\(\\mathbb{S}^{d-1}\\) \\((d-1)\\)-dimensional unit hypersphere \\(\\lambda\\) uniform distribution \\(\\mathbb{S}^{d-1}\\). Practically, computed via Monte Carlo integration.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/swdist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sliced Wasserstein Distance — swdist","text":"","code":"swdist(X, Y, p = 2, ...)"},{"path":"https://www.kisungyou.com/T4transport/reference/swdist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sliced Wasserstein Distance — swdist","text":"X \\((M\\times P)\\) matrix row observations. Y \\((N\\times P)\\) matrix row observations. p exponent order distance (default: 2). ... extra parameters including num_proj number Monte Carlo samples SW computation (default: 496).","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/swdist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sliced Wasserstein Distance — swdist","text":"named list containing distance \\(\\mathcal{SW}_p\\) distance value. projdist length-num_proj vector projected univariate distances.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/swdist.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sliced Wasserstein Distance — swdist","text":"Rabin J, Peyré G, Delon J, Bernot M (2012). “Wasserstein Barycenter Application Texture Mixing.” Bruckstein , ter Haar Romeny BM, Bronstein , Bronstein MM (eds.), Scale Space Variational Methods Computer Vision, volume 6667, 435–446. Springer Berlin Heidelberg, Berlin, Heidelberg. ISBN 978-3-642-24784-2 978-3-642-24785-9, doi:10.1007/978-3-642-24785-9_37 .","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/swdist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sliced Wasserstein Distance — swdist","text":"","code":"# \\donttest{ #------------------------------------------------------------------- #  Sliced-Wasserstein Distance between Two Bivariate Normal # # * class 1 : samples from Gaussian with mean=(-1, -1) # * class 2 : samples from Gaussian with mean=(+1, +1) #------------------------------------------------------------------- # SMALL EXAMPLE set.seed(100) m = 20 n = 30 X = matrix(rnorm(m*2, mean=-1),ncol=2) # m obs. for X Y = matrix(rnorm(n*2, mean=+1),ncol=2) # n obs. for Y  # COMPUTE THE SLICED-WASSERSTEIN DISTANCE outsw <- swdist(X, Y, num_proj=100)  # VISUALIZE # prepare ingredients for plotting plot_x = 1:1000 plot_y = base::cumsum(outsw$projdist)/plot_x  # draw opar <- par(no.readonly=TRUE) plot(plot_x, plot_y, type=\"b\", cex=0.1, lwd=2,      xlab=\"number of MC samples\", ylab=\"distance\",      main=\"Effect of MC Sample Size\") abline(h=outsw$distance, col=\"red\", lwd=2) legend(\"bottomright\", legend=\"SW Distance\",         col=\"red\", lwd=2)  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/wassboot.html","id":null,"dir":"Reference","previous_headings":"","what":"Wasserstein Distance Estimation with Boostrapping — wassboot","title":"Wasserstein Distance Estimation with Boostrapping — wassboot","text":"function computes \\(\\mathcal{W}_p\\) distance two empirical measures using bootstrap order quantify uncertainty estimation.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/wassboot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wasserstein Distance Estimation with Boostrapping — wassboot","text":"","code":"wassboot(X, Y, p = 2, B = 500, wx = NULL, wy = NULL)"},{"path":"https://www.kisungyou.com/T4transport/reference/wassboot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wasserstein Distance Estimation with Boostrapping — wassboot","text":"X \\((M\\times P)\\) matrix row observations. Y \\((N\\times P)\\) matrix row observations. p exponent order distance (default: 2). B number bootstrap samples (default: 500). wx length-\\(M\\) marginal density sums \\(1\\). NULL (default), uniform weight set. wy length-\\(N\\) marginal density sums \\(1\\). NULL (default), uniform weight set.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/wassboot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wasserstein Distance Estimation with Boostrapping — wassboot","text":"named list containing distance \\(\\mathcal{W}_p\\) distance value. boot_samples length-\\(B\\) vector bootstrap samples.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/wassboot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wasserstein Distance Estimation with Boostrapping — wassboot","text":"","code":"# \\donttest{ #------------------------------------------------------------------- #  Boostrapping Wasserstein Distance between Two Bivariate Normals # # * class 1 : samples from Gaussian with mean=(-5, 0) # * class 2 : samples from Gaussian with mean=(+5, 0) #------------------------------------------------------------------- ## SMALL EXAMPLE m = round(runif(1, min=50, max=100)) n = round(runif(1, min=50, max=100)) X = matrix(rnorm(m*2), ncol=2) # m obs. for X Y = matrix(rnorm(n*2), ncol=2) # n obs. for Y  X[,1] = X[,1] - 5 Y[,1] = Y[,1] + 5  ## COMPUTE THE BOOTSTRAP SAMPLES boots = wassboot(X, Y, B=1000)  ## VISUALIZE opar <- par(no.readonly=TRUE) hist(boots$boot_samples, xlab=\"Estimates\", main=\"Bootstrap Samples\") abline(v=boots$distance, lwd=2, col=\"blue\") abline(v=mean(boots$boot_samples), lwd=2, col=\"red\") abline(v=10, col=\"cyan\", lwd=2) legend(\"topright\", c(\"ground truth\",\"estimate\",\"bootstrap mean\"),          col=c(\"cyan\",\"blue\",\"red\"), lwd=2)  par(opar) # }"},{"path":"https://www.kisungyou.com/T4transport/reference/wasserstein.html","id":null,"dir":"Reference","previous_headings":"","what":"Wasserstein Distance via Linear Programming — wasserstein","title":"Wasserstein Distance via Linear Programming — wasserstein","text":"Given two empirical measures $$\\mu = \\sum_{m=1}^M \\mu_m \\delta_{X_m}\\quad\\textrm{}\\quad \\nu = \\sum_{n=1}^N \\nu_n \\delta_{Y_n},$$ \\(p\\)-Wasserstein distance \\(p\\geq 1\\) posited following optimization problem $$   W_p^p(\\mu, \\nu) = \\min_{\\pi \\\\Pi(\\mu, \\nu)} \\sum_{m=1}^M \\sum_{n=1}^N \\pi_{mn} \\|X_m - Y_n\\|^p, $$ \\(\\Pi(\\mu, \\nu)\\) denotes set joint distributions (transport plans) marginals \\(\\mu\\) \\(\\nu\\). function solves problem linear programming, standard approach exact computation empirical Wasserstein distance. Please see section detailed description usage function.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/wasserstein.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wasserstein Distance via Linear Programming — wasserstein","text":"","code":"wasserstein(X, Y, p = 2, wx = NULL, wy = NULL)  wassersteinD(D, p = 2, wx = NULL, wy = NULL)"},{"path":"https://www.kisungyou.com/T4transport/reference/wasserstein.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wasserstein Distance via Linear Programming — wasserstein","text":"X \\((M\\times P)\\) matrix row observations. Y \\((N\\times P)\\) matrix row observations. p exponent order distance (default: 2). wx length-\\(M\\) marginal density sums \\(1\\). NULL (default), uniform weight set. wy length-\\(N\\) marginal density sums \\(1\\). NULL (default), uniform weight set. D \\((M\\times N)\\) distance matrix \\(d(x_m, y_n)\\) two sets observations.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/wasserstein.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wasserstein Distance via Linear Programming — wasserstein","text":"named list containing distance \\(\\mathcal{W}_p\\) distance value. plan \\((M\\times N)\\) nonnegative matrix optimal transport plan.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/wasserstein.html","id":"using-wasserstein-function","dir":"Reference","previous_headings":"","what":"Using wasserstein() function","title":"Wasserstein Distance via Linear Programming — wasserstein","text":"assume empirical measures defined Euclidean space \\(\\mathcal{X}=\\mathbb{R}^d\\), $$\\mu = \\sum_{m=1}^M \\mu_m \\delta_{X_m}\\quad\\textrm{}\\quad \\nu = \\sum_{n=1}^N \\nu_n \\delta_{Y_n}$$ distance metric used standard Euclidean norm \\(d(x,y) = \\|x-y\\|\\). , marginals \\((\\mu_1,\\mu_2,\\ldots,\\mu_M)\\) \\((\\nu_1,\\nu_2,\\ldots,\\nu_N)\\) correspond wx wy, respectively.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/wasserstein.html","id":"using-wassersteind-function","dir":"Reference","previous_headings":"","what":"Using wassersteinD() function","title":"Wasserstein Distance via Linear Programming — wasserstein","text":"distance measures underlying spaces one's interests, option users provide distance matrix D rather vectors, $$D := D_{M\\times N} = d(X_m, Y_n)$$ arbitrary distance metrics beyond \\(\\ell_2\\) norm.","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/wasserstein.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Wasserstein Distance via Linear Programming — wasserstein","text":"Peyré G, Cuturi M (2019). “Computational Optimal Transport: Applications Data Science.” Foundations Trends® Machine Learning, 11(5-6), 355–607. ISSN 1935-8237, 1935-8245, doi:10.1561/2200000073 .","code":""},{"path":"https://www.kisungyou.com/T4transport/reference/wasserstein.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wasserstein Distance via Linear Programming — wasserstein","text":"","code":"#------------------------------------------------------------------- #  Wasserstein Distance between Samples from Two Bivariate Normal # # * class 1 : samples from Gaussian with mean=(-1, -1) # * class 2 : samples from Gaussian with mean=(+1, +1) #------------------------------------------------------------------- ## SMALL EXAMPLE m = 20 n = 10 X = matrix(rnorm(m*2, mean=-1),ncol=2) # m obs. for X Y = matrix(rnorm(n*2, mean=+1),ncol=2) # n obs. for Y  ## COMPUTE WITH DIFFERENT ORDERS out1 = wasserstein(X, Y, p=1) out2 = wasserstein(X, Y, p=2) out5 = wasserstein(X, Y, p=5)  ## VISUALIZE : SHOW THE PLAN AND DISTANCE pm1 = paste0(\"Order p=1\\n distance=\",round(out1$distance,2)) pm2 = paste0(\"Order p=2\\n distance=\",round(out2$distance,2)) pm5 = paste0(\"Order p=5\\n distance=\",round(out5$distance,2))  opar <- par(no.readonly=TRUE) par(mfrow=c(1,3), pty=\"s\") image(out1$plan, axes=FALSE, main=pm1) image(out2$plan, axes=FALSE, main=pm2) image(out5$plan, axes=FALSE, main=pm5)  par(opar)  if (FALSE) { # \\dontrun{ ## COMPARE WITH ANALYTIC RESULTS #  For two Gaussians with same covariance, their  #  2-Wasserstein distance is known so let's compare !  niter = 1000          # number of iterations vdist = rep(0,niter) for (i in 1:niter){   mm = sample(30:50, 1)   nn = sample(30:50, 1)      X = matrix(rnorm(mm*2, mean=-1),ncol=2)   Y = matrix(rnorm(nn*2, mean=+1),ncol=2)      vdist[i] = wasserstein(X, Y, p=2)$distance   if (i%%10 == 0){     print(paste0(\"iteration \",i,\"/\", niter,\" complete.\"))    } }  # Visualize opar <- par(no.readonly=TRUE) hist(vdist, main=\"Monte Carlo Simulation\") abline(v=sqrt(8), lwd=2, col=\"red\") par(opar) } # }"},{"path":"https://www.kisungyou.com/T4transport/news/index.html","id":"t4transport-017","dir":"Changelog","previous_headings":"","what":"T4transport 0.1.7","title":"T4transport 0.1.7","text":"CRAN release: 2025-12-22 Removed dependence CVXR package.","code":""},{"path":"https://www.kisungyou.com/T4transport/news/index.html","id":"t4transport-016","dir":"Changelog","previous_headings":"","what":"T4transport 0.1.6","title":"T4transport 0.1.6","text":"API references restructured. Added number functions histograms, including distance, barycenter, interpolation, median. Added img2measure() extract discrete measure gray-scale image matrix. New family routines Gromov-Wasserstein geometry, gwdist() gwbary(), added.","code":""},{"path":"https://www.kisungyou.com/T4transport/news/index.html","id":"t4transport-015","dir":"Changelog","previous_headings":"","what":"T4transport 0.1.5","title":"T4transport 0.1.5","text":"CRAN release: 2025-11-13 Replaced lpSolve package’s EMD solver Nicolas Bonneel’s highly-optimized C library. Added functions Procrustes-Wasserstein geometry: pwdist() pwbary().","code":""},{"path":"https://www.kisungyou.com/T4transport/news/index.html","id":"t4transport-014","dir":"Changelog","previous_headings":"","what":"T4transport 0.1.4","title":"T4transport 0.1.4","text":"rbarygd() Riemannian gradient descent compute free-support barycenter added.","code":""},{"path":"https://www.kisungyou.com/T4transport/news/index.html","id":"t4transport-013","dir":"Changelog","previous_headings":"","what":"T4transport 0.1.3","title":"T4transport 0.1.3","text":"CRAN release: 2025-05-29 Changed structure package. Applied log-sum-exp trick numerical stability entropic regularization solver. rbary23L() added simple free-support Wasserstein barycenter computation. Two ad hoc median routines images histograms removed.","code":""},{"path":"https://www.kisungyou.com/T4transport/news/index.html","id":"t4transport-012","dir":"Changelog","previous_headings":"","what":"T4transport 0.1.2","title":"T4transport 0.1.2","text":"CRAN release: 2023-04-11 gaussmed1d() gaussmedpd() now fully respects product manifold perspective. gwdist() added Sliced-Wasserstein distance computation.","code":""},{"path":"https://www.kisungyou.com/T4transport/news/index.html","id":"t4transport-011","dir":"Changelog","previous_headings":"","what":"T4transport 0.1.1","title":"T4transport 0.1.1","text":"CRAN release: 2022-09-03 Support special types data. See reference details.","code":""},{"path":"https://www.kisungyou.com/T4transport/news/index.html","id":"t4transport-010","dir":"Changelog","previous_headings":"","what":"T4transport 0.1.0","title":"T4transport 0.1.0","text":"CRAN release: 2020-10-09 Added NEWS.md file track changes package. Initial release.","code":""}]
