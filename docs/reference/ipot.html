<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Wasserstein Distance via Inexact Proximal Point Method — ipot • T4transport</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Wasserstein Distance via Inexact Proximal Point Method — ipot"><meta name="description" content="The Inexact Proximal Point Method (IPOT) offers a computationally efficient approach to approximating
the Wasserstein distance between two empirical measures by iteratively solving a series of regularized
optimal transport problems. This method replaces the entropic regularization used in Sinkhorn's algorithm
with a proximal formulation that avoids the explicit use of entropy, thereby mitigating numerical instabilities.
Let \(C := \|X_m - Y_n\|^p\) be the cost matrix, where \(X_m\) and \(Y_n\) are the support points of two
discrete distributions \(\mu\) and \(\nu\), respectively. The IPOT algorithm solves a sequence of optimization problems:
$$
  \Gamma^{(t+1)} = \arg\min_{\Gamma \in \Pi(\mu, \nu)} \langle \Gamma, C \rangle + \lambda D(\Gamma \| \Gamma^{(t)}),
$$
where \(\lambda &amp;gt; 0\) is the proximal regularization parameter and \(D(\cdot \| \cdot)\) is the Kullback–Leibler
divergence. Each subproblem is solved approximately using a fixed number of inner iterations, making the method inexact.
Unlike entropic methods, IPOT does not require \(\lambda \rightarrow 0\) for convergence to the unregularized Wasserstein
solution. It is therefore more robust to numerical precision issues, especially for small regularization parameters,
and provides a closer approximation to the true optimal transport cost with fewer artifacts."><meta property="og:description" content="The Inexact Proximal Point Method (IPOT) offers a computationally efficient approach to approximating
the Wasserstein distance between two empirical measures by iteratively solving a series of regularized
optimal transport problems. This method replaces the entropic regularization used in Sinkhorn's algorithm
with a proximal formulation that avoids the explicit use of entropy, thereby mitigating numerical instabilities.
Let \(C := \|X_m - Y_n\|^p\) be the cost matrix, where \(X_m\) and \(Y_n\) are the support points of two
discrete distributions \(\mu\) and \(\nu\), respectively. The IPOT algorithm solves a sequence of optimization problems:
$$
  \Gamma^{(t+1)} = \arg\min_{\Gamma \in \Pi(\mu, \nu)} \langle \Gamma, C \rangle + \lambda D(\Gamma \| \Gamma^{(t)}),
$$
where \(\lambda &amp;gt; 0\) is the proximal regularization parameter and \(D(\cdot \| \cdot)\) is the Kullback–Leibler
divergence. Each subproblem is solved approximately using a fixed number of inner iterations, making the method inexact.
Unlike entropic methods, IPOT does not require \(\lambda \rightarrow 0\) for convergence to the unregularized Wasserstein
solution. It is therefore more robust to numerical precision issues, especially for small regularization parameters,
and provides a closer approximation to the true optimal transport cost with fewer artifacts."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">T4transport</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/kisung_you" aria-label="Twitter/X"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kisungyou/T4transport" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../mailto:kisung.you@outlook.com" aria-label="Email"><span class="fa fa-envelope"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Wasserstein Distance via Inexact Proximal Point Method</h1>

      <div class="d-none name"><code>ipot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The Inexact Proximal Point Method (IPOT) offers a computationally efficient approach to approximating
the Wasserstein distance between two empirical measures by iteratively solving a series of regularized
optimal transport problems. This method replaces the entropic regularization used in Sinkhorn's algorithm
with a proximal formulation that avoids the explicit use of entropy, thereby mitigating numerical instabilities.</p>
<p>Let \(C := \|X_m - Y_n\|^p\) be the cost matrix, where \(X_m\) and \(Y_n\) are the support points of two
discrete distributions \(\mu\) and \(\nu\), respectively. The IPOT algorithm solves a sequence of optimization problems:
$$
  \Gamma^{(t+1)} = \arg\min_{\Gamma \in \Pi(\mu, \nu)} \langle \Gamma, C \rangle + \lambda D(\Gamma \| \Gamma^{(t)}),
$$
where \(\lambda &gt; 0\) is the proximal regularization parameter and \(D(\cdot \| \cdot)\) is the Kullback–Leibler
divergence. Each subproblem is solved approximately using a fixed number of inner iterations, making the method inexact.</p>
<p>Unlike entropic methods, IPOT does not require \(\lambda \rightarrow 0\) for convergence to the unregularized Wasserstein
solution. It is therefore more robust to numerical precision issues, especially for small regularization parameters,
and provides a closer approximation to the true optimal transport cost with fewer artifacts.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ipot</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, p <span class="op">=</span> <span class="fl">2</span>, wx <span class="op">=</span> <span class="cn">NULL</span>, wy <span class="op">=</span> <span class="cn">NULL</span>, lambda <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ipotD</span><span class="op">(</span><span class="va">D</span>, p <span class="op">=</span> <span class="fl">2</span>, wx <span class="op">=</span> <span class="cn">NULL</span>, wy <span class="op">=</span> <span class="cn">NULL</span>, lambda <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an \((M\times P)\) matrix of row observations.</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>an \((N\times P)\) matrix of row observations.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>an exponent for the order of the distance (default: 2).</p></dd>


<dt id="arg-wx">wx<a class="anchor" aria-label="anchor" href="#arg-wx"></a></dt>
<dd><p>a length-\(M\) marginal density that sums to \(1\). If <code>NULL</code> (default), uniform weight is set.</p></dd>


<dt id="arg-wy">wy<a class="anchor" aria-label="anchor" href="#arg-wy"></a></dt>
<dd><p>a length-\(N\) marginal density that sums to \(1\). If <code>NULL</code> (default), uniform weight is set.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>a regularization parameter (default: 0.1).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>extra parameters including</p><dl><dt>maxiter</dt>
<dd><p>maximum number of iterations (default: 496).</p></dd>

<dt>abstol</dt>
<dd><p>stopping criterion for iterations (default: 1e-10).</p></dd>

<dt>L</dt>
<dd><p>small number of inner loop iterations (default: 1).</p></dd>


</dl></dd>


<dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>an \((M\times N)\) distance matrix \(d(x_m, y_n)\) between two sets of observations.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a named list containing</p><dl><dt>distance</dt>
<dd><p>\(\mathcal{W}_p\) distance value</p></dd>

<dt>plan</dt>
<dd><p>an \((M\times N)\) nonnegative matrix for the optimal transport plan.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Xie Y, Wang X, Wang R, Zha H (2020-07-22/2020-07-25).
“A Fast Proximal Point Method for Computing Exact Wasserstein Distance.”
In Adams RP, Gogate V (eds.), <em>Proceedings of the 35th Uncertainty in Artificial Intelligence Conference</em>, volume 115 of <em>Proceedings of Machine Learning Research</em>, 433–453.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">#  Wasserstein Distance between Samples from Two Bivariate Normal</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># * class 1 : samples from Gaussian with mean=(-1, -1)</span></span></span>
<span class="r-in"><span><span class="co"># * class 2 : samples from Gaussian with mean=(+1, +1)</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## SMALL EXAMPLE</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="fl">2</span>, mean<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># m obs. for X</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="fl">2</span>, mean<span class="op">=</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># n obs. for Y</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## COMPARE WITH WASSERSTEIN </span></span></span>
<span class="r-in"><span><span class="va">outw</span> <span class="op">=</span> <span class="fu"><a href="wasserstein.html">wasserstein</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ipt1</span> <span class="op">=</span> <span class="fu">ipot</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, lambda<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ipt2</span> <span class="op">=</span> <span class="fu">ipot</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, lambda<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## VISUALIZE : SHOW THE PLAN AND DISTANCE</span></span></span>
<span class="r-in"><span><span class="va">pmw</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Exact plan\n dist="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">outw</span><span class="op">$</span><span class="va">distance</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pm1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"IPOT (lambda=1)\n dist="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ipt1</span><span class="op">$</span><span class="va">distance</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pm2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"IPOT (lambda=10)\n dist="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ipt2</span><span class="op">$</span><span class="va">distance</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, pty<span class="op">=</span><span class="st">"s"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">outw</span><span class="op">$</span><span class="va">plan</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, main<span class="op">=</span><span class="va">pmw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">ipt1</span><span class="op">$</span><span class="va">plan</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, main<span class="op">=</span><span class="va">pm1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">ipt2</span><span class="op">$</span><span class="va">plan</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, main<span class="op">=</span><span class="va">pm2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ipot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kisung You.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

