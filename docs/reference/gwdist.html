<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Gromov-Wasserstein Distance — gwdist • T4transport</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gromov-Wasserstein Distance — gwdist"><meta name="description" content="Computes the Gromov-Wasserstein (GW) distance between two metric measure spaces.
Given two distance matrices \(D_X\) and \(D_Y\) along with their
respective marginal distributions, the function solves the GW optimization
problem to obtain both the distance value and an associated optimal transport
plan.
The GW distance provides a way to compare datasets that may not lie in the
same ambient space by focusing on the intrinsic geometric structure encoded
in the pairwise distances. This implementation supports multiple optimization
schemes, including majorization–minimization (MM), proximal gradient (PG), and
Frank–Wolfe (FW)."><meta property="og:description" content="Computes the Gromov-Wasserstein (GW) distance between two metric measure spaces.
Given two distance matrices \(D_X\) and \(D_Y\) along with their
respective marginal distributions, the function solves the GW optimization
problem to obtain both the distance value and an associated optimal transport
plan.
The GW distance provides a way to compare datasets that may not lie in the
same ambient space by focusing on the intrinsic geometric structure encoded
in the pairwise distances. This implementation supports multiple optimization
schemes, including majorization–minimization (MM), proximal gradient (PG), and
Frank–Wolfe (FW)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">T4transport</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/basic_compute_distance.html">Computing the Wasserstein distance</a></li>
    <li><hr class="dropdown-divider"></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/kisung_you" aria-label="Twitter/X"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kisungyou/T4transport" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../mailto:kisung.you@outlook.com" aria-label="Email"><span class="fa fa-envelope"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Gromov-Wasserstein Distance</h1>

      <div class="d-none name"><code>gwdist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the Gromov-Wasserstein (GW) distance between two metric measure spaces.
Given two distance matrices \(D_X\) and \(D_Y\) along with their
respective marginal distributions, the function solves the GW optimization
problem to obtain both the distance value and an associated optimal transport
plan.</p>
<p>The GW distance provides a way to compare datasets that may not lie in the
same ambient space by focusing on the intrinsic geometric structure encoded
in the pairwise distances. This implementation supports multiple optimization
schemes, including majorization–minimization (MM), proximal gradient (PG), and
Frank–Wolfe (FW).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gwdist</span><span class="op">(</span><span class="va">Dx</span>, <span class="va">Dy</span>, wx <span class="op">=</span> <span class="cn">NULL</span>, wy <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dx">Dx<a class="anchor" aria-label="anchor" href="#arg-dx"></a></dt>
<dd><p>an \((M\times M)\) distance matrix or a <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> object of compatible size.</p></dd>


<dt id="arg-dy">Dy<a class="anchor" aria-label="anchor" href="#arg-dy"></a></dt>
<dd><p>an \((N\times N)\) distance matrix or a <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> object of compatible size.</p></dd>


<dt id="arg-wx">wx<a class="anchor" aria-label="anchor" href="#arg-wx"></a></dt>
<dd><p>a length-\(M\) marginal density that sums to \(1\). If <code>NULL</code> (default), uniform weight is set.</p></dd>


<dt id="arg-wy">wy<a class="anchor" aria-label="anchor" href="#arg-wy"></a></dt>
<dd><p>a length-\(N\) marginal density that sums to \(1\). If <code>NULL</code> (default), uniform weight is set.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>extra parameters including</p><dl><dt>maxiter</dt>
<dd><p>maximum number of iterations (default: 10).</p></dd>

<dt>abstol</dt>
<dd><p>stopping criterion for iterations (default: 1e-6).</p></dd>

<dt>method</dt>
<dd><p>optimization method to use; can be one of <code>"mm"</code>, <code>"pg"</code>, or <code>"fw"</code> (default).</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a named list containing</p><dl><dt>distance</dt>
<dd><p>the computed GW distance value.</p></dd>

<dt>plan</dt>
<dd><p>an \((M\times N)\) nonnegative matrix for the optimal transport plan.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mémoli F (2011).
“Gromov–Wasserstein Distances and the Metric Approach to Object Matching.”
<em>Foundations of Computational Mathematics</em>, <b>11</b>(4), 417–487.
ISSN 1615-3375, 1615-3383.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">#                           Description</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># * class 1 : iris dataset (columns 1-4) with perturbations</span></span></span>
<span class="r-in"><span><span class="co"># * class 2 : class 1 rotated randomly in R^4</span></span></span>
<span class="r-in"><span><span class="co"># * class 3 : samples from N((0,0), I)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#  We draw 10 empirical measures from each and compare </span></span></span>
<span class="r-in"><span><span class="co">#  the regular Wasserstein and GW distance. It is expected that </span></span></span>
<span class="r-in"><span><span class="co">#  the GW distance between class 1 and class 2 is negligible, </span></span></span>
<span class="r-in"><span><span class="co">#  while the regular Wasserstein distance is large. For simplicity, </span></span></span>
<span class="r-in"><span><span class="co">#  limit the cardinalities to 20.</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## GENERATE DATA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#  prepare empty lists</span></span></span>
<span class="r-in"><span><span class="va">inputs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, length<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#  generate class 1 and 2</span></span></span>
<span class="r-in"><span><span class="va">iris_mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">150</span>,<span class="fl">20</span><span class="op">)</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">inputs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">iris_mat</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">inputs</span><span class="op">[[</span><span class="va">i</span><span class="op">+</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">inputs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/qraux.html" class="external-link">qr.Q</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">16</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co">#  generate class 3</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">21</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">inputs</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## COMPUTE</span></span></span>
<span class="r-in"><span><span class="co">#  empty arrays</span></span></span>
<span class="r-in"><span><span class="va">dist_RW</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dist_GW</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#  compute pairwise distances</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">29</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="va">inputs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">Dx</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">inputs</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">Dy</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dist_RW</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dist_RW</span><span class="op">[</span><span class="va">j</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="wasserstein.html">wasserstein</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span><span class="op">$</span><span class="va">distance</span></span></span>
<span class="r-in"><span>  <span class="va">dist_GW</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dist_GW</span><span class="op">[</span><span class="va">j</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">gwdist</span><span class="op">(</span><span class="va">Dx</span>, <span class="va">Dy</span><span class="op">)</span><span class="op">$</span><span class="va">distance</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## VISUALIZE</span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, pty<span class="op">=</span><span class="st">"s"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">dist_RW</span>, xaxt<span class="op">=</span><span class="st">"n"</span>, yaxt<span class="op">=</span><span class="st">"n"</span>, main<span class="op">=</span><span class="st">"Regular Wasserstein distance"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">dist_GW</span>, xaxt<span class="op">=</span><span class="st">"n"</span>, yaxt<span class="op">=</span><span class="st">"n"</span>, main<span class="op">=</span><span class="st">"Gromov-Wasserstein distance"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kisung You.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

